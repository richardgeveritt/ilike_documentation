<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>3.4 Factor: simulation-based likelihood | ilike documentation</title>
  <meta name="description" content="Documentation for the ilike R package." />
  <meta name="generator" content="bookdown 0.37 and GitBook 2.6.7" />

  <meta property="og:title" content="3.4 Factor: simulation-based likelihood | ilike documentation" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="Documentation for the ilike R package." />
  <meta name="github-repo" content="richardgeveritt/ilike_documentation" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="3.4 Factor: simulation-based likelihood | ilike documentation" />
  
  <meta name="twitter:description" content="Documentation for the ilike R package." />
  

<meta name="author" content="Richard G. Everitt" />


<meta name="date" content="2024-10-30" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="factor-custom-likelihood.html"/>
<link rel="next" href="factor-linear-gaussian-model.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>
<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">ilike documentation</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Preface</a>
<ul>
<li class="chapter" data-level="1.1" data-path="toy-example.html"><a href="toy-example.html"><i class="fa fa-check"></i><b>1.1</b> Example</a>
<ul>
<li class="chapter" data-level="1.1.1" data-path="toy-example.html"><a href="toy-example.html#model"><i class="fa fa-check"></i><b>1.1.1</b> Model</a></li>
<li class="chapter" data-level="1.1.2" data-path="toy-example.html"><a href="toy-example.html#ilike-file"><i class="fa fa-check"></i><b>1.1.2</b> ilike file</a></li>
<li class="chapter" data-level="1.1.3" data-path="toy-example.html"><a href="toy-example.html#running-mcmc"><i class="fa fa-check"></i><b>1.1.3</b> Running MCMC</a></li>
<li class="chapter" data-level="1.1.4" data-path="toy-example.html"><a href="toy-example.html#visualising-the-output"><i class="fa fa-check"></i><b>1.1.4</b> Visualising the output</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="ilike-files.html"><a href="ilike-files.html"><i class="fa fa-check"></i><b>2</b> ilike files</a>
<ul>
<li class="chapter" data-level="2.1" data-path="file-structure.html"><a href="file-structure.html"><i class="fa fa-check"></i><b>2.1</b> File structure</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="file-structure.html"><a href="file-structure.html#blocks-automatically"><i class="fa fa-check"></i><b>2.1.1</b> Specifying blocks automatically</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="compiling.html"><a href="compiling.html"><i class="fa fa-check"></i><b>2.2</b> Compiling an ilike file</a></li>
<li class="chapter" data-level="2.3" data-path="C.html"><a href="C.html"><i class="fa fa-check"></i><b>2.3</b> C++ functions</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="C.html"><a href="C.html#including-additional-code"><i class="fa fa-check"></i><b>2.3.1</b> Including additional code</a></li>
<li class="chapter" data-level="2.3.2" data-path="C.html"><a href="C.html#ilike-cpp-classes"><i class="fa fa-check"></i><b>2.3.2</b> ilike C++ classes</a></li>
<li class="chapter" data-level="2.3.3" data-path="C.html"><a href="C.html#ilike-cpp-functions"><i class="fa fa-check"></i><b>2.3.3</b> ilike C++ functions</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="R.html"><a href="R.html"><i class="fa fa-check"></i><b>2.4</b> R functions</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="R.html"><a href="R.html#function-arguments-for-r-functions"><i class="fa fa-check"></i><b>2.4.1</b> Function arguments for R functions</a></li>
<li class="chapter" data-level="2.4.2" data-path="R.html"><a href="R.html#function-headers-for-r-functions"><i class="fa fa-check"></i><b>2.4.2</b> Function headers for R functions</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="python.html"><a href="python.html"><i class="fa fa-check"></i><b>2.5</b> Python functions</a>
<ul>
<li class="chapter" data-level="2.5.1" data-path="python.html"><a href="python.html#using-jax-to-calculate-gradients"><i class="fa fa-check"></i><b>2.5.1</b> Using jax to calculate gradients</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="julia.html"><a href="julia.html"><i class="fa fa-check"></i><b>2.6</b> Julia functions</a></li>
<li class="chapter" data-level="2.7" data-path="ilike-functions.html"><a href="ilike-functions.html"><i class="fa fa-check"></i><b>2.7</b> ilike functions</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="models.html"><a href="models.html"><i class="fa fa-check"></i><b>3</b> Models</a>
<ul>
<li class="chapter" data-level="3.1" data-path="factor-custom-prior.html"><a href="factor-custom-prior.html"><i class="fa fa-check"></i><b>3.1</b> Factor: custom prior</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="factor-custom-prior.html"><a href="factor-custom-prior.html#evaluate_log_prior"><i class="fa fa-check"></i><b>3.1.1</b> evaluate_log_prior</a></li>
<li class="chapter" data-level="3.1.2" data-path="factor-custom-prior.html"><a href="factor-custom-prior.html#simulate_prior"><i class="fa fa-check"></i><b>3.1.2</b> simulate_prior</a></li>
<li class="chapter" data-level="3.1.3" data-path="factor-custom-prior.html"><a href="factor-custom-prior.html#evaluate_gradient_log_prior"><i class="fa fa-check"></i><b>3.1.3</b> evaluate_gradient_log_prior</a></li>
<li class="chapter" data-level="3.1.4" data-path="factor-custom-prior.html"><a href="factor-custom-prior.html#evaluate_second_gradient_log_prior"><i class="fa fa-check"></i><b>3.1.4</b> evaluate_second_gradient_log_prior</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="ilike-prior.html"><a href="ilike-prior.html"><i class="fa fa-check"></i><b>3.2</b> Factor: ilike prior</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="ilike-prior.html"><a href="ilike-prior.html#prior-ilike-functions"><i class="fa fa-check"></i><b>3.2.1</b> prior (ilike functions)</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="factor-custom-likelihood.html"><a href="factor-custom-likelihood.html"><i class="fa fa-check"></i><b>3.3</b> Factor: custom likelihood</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="factor-custom-likelihood.html"><a href="factor-custom-likelihood.html#evaluate_log_likelihood"><i class="fa fa-check"></i><b>3.3.1</b> evaluate_log_likelihood</a></li>
<li class="chapter" data-level="3.3.2" data-path="factor-custom-likelihood.html"><a href="factor-custom-likelihood.html#evaluate_gradient_log_likelihood"><i class="fa fa-check"></i><b>3.3.2</b> evaluate_gradient_log_likelihood</a></li>
<li class="chapter" data-level="3.3.3" data-path="factor-custom-likelihood.html"><a href="factor-custom-likelihood.html#evaluate_second_gradient_log_likelihood"><i class="fa fa-check"></i><b>3.3.3</b> evaluate_second_gradient_log_likelihood</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="factor-simulation-based-likelihood.html"><a href="factor-simulation-based-likelihood.html"><i class="fa fa-check"></i><b>3.4</b> Factor: simulation-based likelihood</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="factor-simulation-based-likelihood.html"><a href="factor-simulation-based-likelihood.html#simulate_data_model"><i class="fa fa-check"></i><b>3.4.1</b> simulate_data_model</a></li>
<li class="chapter" data-level="3.4.2" data-path="factor-simulation-based-likelihood.html"><a href="factor-simulation-based-likelihood.html#data_variable"><i class="fa fa-check"></i><b>3.4.2</b> data_variable</a></li>
<li class="chapter" data-level="3.4.3" data-path="factor-simulation-based-likelihood.html"><a href="factor-simulation-based-likelihood.html#summary_statistics"><i class="fa fa-check"></i><b>3.4.3</b> summary_statistics</a></li>
<li class="chapter" data-level="3.4.4" data-path="factor-simulation-based-likelihood.html"><a href="factor-simulation-based-likelihood.html#sbi_likelihood-ilike-functions"><i class="fa fa-check"></i><b>3.4.4</b> sbi_likelihood (ilike functions)</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="factor-linear-gaussian-model.html"><a href="factor-linear-gaussian-model.html"><i class="fa fa-check"></i><b>3.5</b> Factor: linear-Gaussian model</a>
<ul>
<li class="chapter" data-level="3.5.1" data-path="factor-linear-gaussian-model.html"><a href="factor-linear-gaussian-model.html#linear_gaussian_data_variable"><i class="fa fa-check"></i><b>3.5.1</b> linear_gaussian_data_variable</a></li>
<li class="chapter" data-level="3.5.2" data-path="factor-linear-gaussian-model.html"><a href="factor-linear-gaussian-model.html#linear_gaussian_data_state_variable"><i class="fa fa-check"></i><b>3.5.2</b> linear_gaussian_data_state_variable</a></li>
<li class="chapter" data-level="3.5.3" data-path="factor-linear-gaussian-model.html"><a href="factor-linear-gaussian-model.html#linear_gaussian_data_matrix"><i class="fa fa-check"></i><b>3.5.3</b> linear_gaussian_data_matrix</a></li>
<li class="chapter" data-level="3.5.4" data-path="factor-linear-gaussian-model.html"><a href="factor-linear-gaussian-model.html#linear_gaussian_data_covariance"><i class="fa fa-check"></i><b>3.5.4</b> linear_gaussian_data_covariance</a></li>
<li class="chapter" data-level="3.5.5" data-path="factor-linear-gaussian-model.html"><a href="factor-linear-gaussian-model.html#linear_gaussian_data_model-ilike-function"><i class="fa fa-check"></i><b>3.5.5</b> linear_gaussian_data_model (ilike function)</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="factor-nonlinear-gaussian-model.html"><a href="factor-nonlinear-gaussian-model.html"><i class="fa fa-check"></i><b>3.6</b> Factor: nonlinear-Gaussian model</a>
<ul>
<li class="chapter" data-level="3.6.1" data-path="factor-nonlinear-gaussian-model.html"><a href="factor-nonlinear-gaussian-model.html#nonlinear_gaussian_data_variable"><i class="fa fa-check"></i><b>3.6.1</b> nonlinear_gaussian_data_variable</a></li>
<li class="chapter" data-level="3.6.2" data-path="factor-nonlinear-gaussian-model.html"><a href="factor-nonlinear-gaussian-model.html#nonlinear_gaussian_data_function"><i class="fa fa-check"></i><b>3.6.2</b> nonlinear_gaussian_data_function</a></li>
<li class="chapter" data-level="3.6.3" data-path="factor-nonlinear-gaussian-model.html"><a href="factor-nonlinear-gaussian-model.html#nonlinear_gaussian_data_covariance"><i class="fa fa-check"></i><b>3.6.3</b> nonlinear_gaussian_data_covariance</a></li>
</ul></li>
<li class="chapter" data-level="3.7" data-path="factor-algorithmic-likelihood.html"><a href="factor-algorithmic-likelihood.html"><i class="fa fa-check"></i><b>3.7</b> Factor: algorithmic likelihood</a>
<ul>
<li class="chapter" data-level="3.7.1" data-path="factor-algorithmic-likelihood.html"><a href="factor-algorithmic-likelihood.html#algorithmic_likelihood-ilike-functions"><i class="fa fa-check"></i><b>3.7.1</b> algorithmic_likelihood (ilike functions)</a></li>
</ul></li>
<li class="chapter" data-level="3.8" data-path="transition-model-linear-gaussian.html"><a href="transition-model-linear-gaussian.html"><i class="fa fa-check"></i><b>3.8</b> Transition model: linear-Gaussian</a>
<ul>
<li class="chapter" data-level="3.8.1" data-path="transition-model-linear-gaussian.html"><a href="transition-model-linear-gaussian.html#linear_gaussian_transition_variable"><i class="fa fa-check"></i><b>3.8.1</b> linear_gaussian_transition_variable</a></li>
<li class="chapter" data-level="3.8.2" data-path="transition-model-linear-gaussian.html"><a href="transition-model-linear-gaussian.html#linear_gaussian_transition_matrix"><i class="fa fa-check"></i><b>3.8.2</b> linear_gaussian_transition_matrix</a></li>
<li class="chapter" data-level="3.8.3" data-path="transition-model-linear-gaussian.html"><a href="transition-model-linear-gaussian.html#linear_gaussian_transition_covariance"><i class="fa fa-check"></i><b>3.8.3</b> linear_gaussian_transition_covariance</a></li>
<li class="chapter" data-level="3.8.4" data-path="transition-model-linear-gaussian.html"><a href="transition-model-linear-gaussian.html#linear_gaussian_transition_model-ilike-function"><i class="fa fa-check"></i><b>3.8.4</b> linear_gaussian_transition_model (ilike function)</a></li>
</ul></li>
<li class="chapter" data-level="3.9" data-path="transition-model-nonlinear-gaussian.html"><a href="transition-model-nonlinear-gaussian.html"><i class="fa fa-check"></i><b>3.9</b> Transition model: nonlinear-Gaussian</a>
<ul>
<li class="chapter" data-level="3.9.1" data-path="transition-model-nonlinear-gaussian.html"><a href="transition-model-nonlinear-gaussian.html#nonlinear_gaussian_transition_variable"><i class="fa fa-check"></i><b>3.9.1</b> nonlinear_gaussian_transition_variable</a></li>
<li class="chapter" data-level="3.9.2" data-path="transition-model-nonlinear-gaussian.html"><a href="transition-model-nonlinear-gaussian.html#nonlinear_gaussian_transition_function"><i class="fa fa-check"></i><b>3.9.2</b> nonlinear_gaussian_transition_function</a></li>
<li class="chapter" data-level="3.9.3" data-path="transition-model-nonlinear-gaussian.html"><a href="transition-model-nonlinear-gaussian.html#nonlinear_gaussian_transition_covariance"><i class="fa fa-check"></i><b>3.9.3</b> nonlinear_gaussian_transition_covariance</a></li>
</ul></li>
<li class="chapter" data-level="3.10" data-path="transition-model-custom.html"><a href="transition-model-custom.html"><i class="fa fa-check"></i><b>3.10</b> Transition model: custom</a>
<ul>
<li class="chapter" data-level="3.10.1" data-path="transition-model-custom.html"><a href="transition-model-custom.html#simulate_transition-model"><i class="fa fa-check"></i><b>3.10.1</b> simulate_transition model</a></li>
<li class="chapter" data-level="3.10.2" data-path="transition-model-custom.html"><a href="transition-model-custom.html#evaluate_log_transition_model"><i class="fa fa-check"></i><b>3.10.2</b> evaluate_log_transition_model</a></li>
</ul></li>
<li class="chapter" data-level="3.11" data-path="data-block.html"><a href="data-block.html"><i class="fa fa-check"></i><b>3.11</b> Data block</a>
<ul>
<li class="chapter" data-level="3.11.1" data-path="data-block.html"><a href="data-block.html#data"><i class="fa fa-check"></i><b>3.11.1</b> data</a></li>
</ul></li>
<li class="chapter" data-level="3.12" data-path="importance-proposal-custom.html"><a href="importance-proposal-custom.html"><i class="fa fa-check"></i><b>3.12</b> Importance proposal: custom</a>
<ul>
<li class="chapter" data-level="3.12.1" data-path="importance-proposal-custom.html"><a href="importance-proposal-custom.html#simulate_importance_proposal"><i class="fa fa-check"></i><b>3.12.1</b> simulate_importance_proposal</a></li>
<li class="chapter" data-level="3.12.2" data-path="importance-proposal-custom.html"><a href="importance-proposal-custom.html#evaluate_log_importance_proposal"><i class="fa fa-check"></i><b>3.12.2</b> evaluate_log_importance_proposal</a></li>
</ul></li>
<li class="chapter" data-level="3.13" data-path="importance-proposal-ilike.html"><a href="importance-proposal-ilike.html"><i class="fa fa-check"></i><b>3.13</b> Importance proposal: ilike</a>
<ul>
<li class="chapter" data-level="3.13.1" data-path="importance-proposal-ilike.html"><a href="importance-proposal-ilike.html#importance_proposal-ilike-functions"><i class="fa fa-check"></i><b>3.13.1</b> importance_proposal (ilike functions)</a></li>
</ul></li>
<li class="chapter" data-level="3.14" data-path="mh-proposal-custom.html"><a href="mh-proposal-custom.html"><i class="fa fa-check"></i><b>3.14</b> MH proposal: custom</a>
<ul>
<li class="chapter" data-level="3.14.1" data-path="mh-proposal-custom.html"><a href="mh-proposal-custom.html#simulate_mh_proposal"><i class="fa fa-check"></i><b>3.14.1</b> simulate_mh_proposal</a></li>
<li class="chapter" data-level="3.14.2" data-path="mh-proposal-custom.html"><a href="mh-proposal-custom.html#evaluate_log_mh_proposal"><i class="fa fa-check"></i><b>3.14.2</b> evaluate_log_mh_proposal</a></li>
</ul></li>
<li class="chapter" data-level="3.15" data-path="mh-proposal-ilike.html"><a href="mh-proposal-ilike.html"><i class="fa fa-check"></i><b>3.15</b> MH proposal: ilike</a>
<ul>
<li class="chapter" data-level="3.15.1" data-path="mh-proposal-ilike.html"><a href="mh-proposal-ilike.html#mh_proposal-ilike-functions"><i class="fa fa-check"></i><b>3.15.1</b> mh_proposal (ilike functions)</a></li>
</ul></li>
<li class="chapter" data-level="3.16" data-path="method-block.html"><a href="method-block.html"><i class="fa fa-check"></i><b>3.16</b> Method block</a>
<ul>
<li class="chapter" data-level="3.16.1" data-path="method-block.html"><a href="method-block.html#filter"><i class="fa fa-check"></i><b>3.16.1</b> filter</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="inference.html"><a href="inference.html"><i class="fa fa-check"></i><b>4</b> Inference algorithms</a>
<ul>
<li class="chapter" data-level="4.1" data-path="random-numbers.html"><a href="random-numbers.html"><i class="fa fa-check"></i><b>4.1</b> Random numbers</a></li>
<li class="chapter" data-level="4.2" data-path="parameters.html"><a href="parameters.html"><i class="fa fa-check"></i><b>4.2</b> Model and algorithm parameters</a></li>
<li class="chapter" data-level="4.3" data-path="importance-sampling.html"><a href="importance-sampling.html"><i class="fa fa-check"></i><b>4.3</b> Importance sampling</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="importance-sampling.html"><a href="importance-sampling.html#ilike-file-requirements"><i class="fa fa-check"></i><b>4.3.1</b> .ilike file requirements</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html"><i class="fa fa-check"></i><b>4.4</b> Markov chain Monte Carlo</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#ilike-file-requirements-1"><i class="fa fa-check"></i><b>4.4.1</b> .ilike file requirements</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="sequential-monte-carlo.html"><a href="sequential-monte-carlo.html"><i class="fa fa-check"></i><b>4.5</b> Sequential Monte Carlo</a>
<ul>
<li class="chapter" data-level="4.5.1" data-path="sequential-monte-carlo.html"><a href="sequential-monte-carlo.html#ilike-file-requirements-2"><i class="fa fa-check"></i><b>4.5.1</b> .ilike file requirements</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="iterative-ensemble-kalman-inversion.html"><a href="iterative-ensemble-kalman-inversion.html"><i class="fa fa-check"></i><b>4.6</b> Iterative ensemble Kalman inversion</a>
<ul>
<li class="chapter" data-level="4.6.1" data-path="iterative-ensemble-kalman-inversion.html"><a href="iterative-ensemble-kalman-inversion.html#ilike-file-requirements-3"><i class="fa fa-check"></i><b>4.6.1</b> .ilike file requirements</a></li>
</ul></li>
<li class="chapter" data-level="4.7" data-path="kf.html"><a href="kf.html"><i class="fa fa-check"></i><b>4.7</b> Kalman filters</a>
<ul>
<li class="chapter" data-level="4.7.1" data-path="kf.html"><a href="kf.html#ilike-file-requirements-4"><i class="fa fa-check"></i><b>4.7.1</b> .ilike file requirements</a></li>
</ul></li>
<li class="chapter" data-level="4.8" data-path="pf.html"><a href="pf.html"><i class="fa fa-check"></i><b>4.8</b> Particle filters</a>
<ul>
<li class="chapter" data-level="4.8.1" data-path="pf.html"><a href="pf.html#ilike-file-requirements-5"><i class="fa fa-check"></i><b>4.8.1</b> .ilike file requirements</a></li>
</ul></li>
<li class="chapter" data-level="4.9" data-path="enkf.html"><a href="enkf.html"><i class="fa fa-check"></i><b>4.9</b> Ensemble Kalman filters</a>
<ul>
<li class="chapter" data-level="4.9.1" data-path="enkf.html"><a href="enkf.html#ilike-file-requirements-6"><i class="fa fa-check"></i><b>4.9.1</b> .ilike file requirements</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="output.html"><a href="output.html"><i class="fa fa-check"></i><b>5</b> Loading and visualising output</a>
<ul>
<li class="chapter" data-level="5.1" data-path="is-and-smc-output.html"><a href="is-and-smc-output.html"><i class="fa fa-check"></i><b>5.1</b> IS and SMC output</a></li>
<li class="chapter" data-level="5.2" data-path="ensemble-kalman-output.html"><a href="ensemble-kalman-output.html"><i class="fa fa-check"></i><b>5.2</b> Ensemble Kalman output</a></li>
<li class="chapter" data-level="5.3" data-path="mcmc-output.html"><a href="mcmc-output.html"><i class="fa fa-check"></i><b>5.3</b> MCMC output</a></li>
<li class="chapter" data-level="5.4" data-path="further-detail-about-output-files.html"><a href="further-detail-about-output-files.html"><i class="fa fa-check"></i><b>5.4</b> Further detail about output files</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="examples.html"><a href="examples.html"><i class="fa fa-check"></i><b>6</b> Examples</a>
<ul>
<li class="chapter" data-level="6.1" data-path="running-code.html"><a href="running-code.html"><i class="fa fa-check"></i><b>6.1</b> Running code</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="bugs.html"><a href="bugs.html"><i class="fa fa-check"></i><b>7</b> Known issues and glaring omissions</a>
<ul>
<li class="chapter" data-level="7.1" data-path="known-issues.html"><a href="known-issues.html"><i class="fa fa-check"></i><b>7.1</b> Known issues</a></li>
<li class="chapter" data-level="7.2" data-path="glaring-omissions.html"><a href="glaring-omissions.html"><i class="fa fa-check"></i><b>7.2</b> Glaring omissions</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">ilike documentation</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="factor-simulation-based-likelihood" class="section level2 hasAnchor" number="3.4">
<h2><span class="header-section-number">3.4</span> Factor: simulation-based likelihood<a href="factor-simulation-based-likelihood.html#factor-simulation-based-likelihood" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The functions in this section allow the specification of a likelihood through a function that simulates a data generating process, for example through approximate Bayesian computation. There are three function types that are required to be specified for all simulation-based likelihoods:</p>
<ul>
<li><p><code>simulate_data_model</code>, which simulates the data generating process.</p></li>
<li><p><code>data_variable</code>, which specifies the variable or variables in the simulation that we wish to treat as observed for the purposes of constructing a likelihood based on the simulation.</p></li>
<li><p><code>sbi_likelihood</code>, which uses an ilike function to define the desired simulation-based likelihood.</p></li>
</ul>
<p>It is also possible to reduce the observed data to summary statistcs (though the use of the <code>summary_statistics</code> function type) for use in the simulation-based likelihood.</p>
<div id="simulate_data_model" class="section level3 hasAnchor" number="3.4.1">
<h3><span class="header-section-number">3.4.1</span> simulate_data_model<a href="factor-simulation-based-likelihood.html#simulate_data_model" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The <code>simulate_data_model</code> function type simulates the data generating process.</p>
<p>Input: (C++ only) The random number generator to be used in the simulation.</p>
<p>– of type <code>RandomNumberGenerator &amp;</code> in a C++ function</p>
<p>Input: The parameters at which to simulate the data.</p>
<p>– of type <code>const Parameters &amp;</code> in a C++ function</p>
<p>– available as R list <code>parameters</code> in an R function</p>
<p>Output: The simulated data.</p>
<p>– of class <code>Data</code> in a C++ function</p>
<p>– an R list in R, where at present the interface restricts the user to a single vector/matrix of data, which is indexed by a string provided by the user to the left of an <code>=</code> sign in the function header.</p>
<p>C++ example:</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb16-1"><a href="factor-simulation-based-likelihood.html#cb16-1" tabindex="-1"></a><span class="co">/***simulate_data_model***/</span></span>
<span id="cb16-2"><a href="factor-simulation-based-likelihood.html#cb16-2" tabindex="-1"></a>Data simulate_data_model<span class="op">(</span>RandomNumberGenerator <span class="op">&amp;</span>rng<span class="op">,</span></span>
<span id="cb16-3"><a href="factor-simulation-based-likelihood.html#cb16-3" tabindex="-1"></a>                         <span class="at">const</span> Parameters <span class="op">&amp;</span>parameters<span class="op">)</span></span>
<span id="cb16-4"><a href="factor-simulation-based-likelihood.html#cb16-4" tabindex="-1"></a><span class="op">{</span></span>
<span id="cb16-5"><a href="factor-simulation-based-likelihood.html#cb16-5" tabindex="-1"></a>  arma<span class="op">::</span>colvec y <span class="op">=</span> rnorm<span class="op">(</span>rng<span class="op">,</span><span class="dv">100</span><span class="op">,</span>parameters<span class="op">[</span><span class="st">&quot;θ&quot;</span><span class="op">][</span><span class="dv">0</span><span class="op">],</span><span class="fl">1.0</span><span class="op">);</span></span>
<span id="cb16-6"><a href="factor-simulation-based-likelihood.html#cb16-6" tabindex="-1"></a>  <span class="cf">return</span> Data<span class="op">(</span><span class="st">&quot;y&quot;</span><span class="op">,</span> y<span class="op">);</span></span>
<span id="cb16-7"><a href="factor-simulation-based-likelihood.html#cb16-7" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<p>R example:</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb17-1"><a href="factor-simulation-based-likelihood.html#cb17-1" tabindex="-1"></a><span class="co">/***simulate_data_model,y=rnorm(100,parameters$θ,1)***/</span></span></code></pre></div>
</div>
<div id="data_variable" class="section level3 hasAnchor" number="3.4.2">
<h3><span class="header-section-number">3.4.2</span> data_variable<a href="factor-simulation-based-likelihood.html#data_variable" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The <code>data_variable</code> function type specifies the variable or variables in the simulation that we wish to treat as observed for the purposes of constructing a likelihood based on the simulation. There are no input arguments.</p>
<p>Output: The variable or variables in the simulation that we wish to treat as observed for the purposes of constructing a likelihood based on the simulation. To specify multiple output variables they must be separated by a semi-colon (with no spaces).</p>
<p>– of type <code>const std::string &amp;</code> in a C++ function</p>
<p>– a string in R.</p>
<p>C++ example:</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb18-1"><a href="factor-simulation-based-likelihood.html#cb18-1" tabindex="-1"></a><span class="co">/***data_variable***/</span></span>
<span id="cb18-2"><a href="factor-simulation-based-likelihood.html#cb18-2" tabindex="-1"></a><span class="bu">std::</span>string a_variable<span class="op">()</span></span>
<span id="cb18-3"><a href="factor-simulation-based-likelihood.html#cb18-3" tabindex="-1"></a><span class="op">{</span></span>
<span id="cb18-4"><a href="factor-simulation-based-likelihood.html#cb18-4" tabindex="-1"></a>  <span class="cf">return</span> <span class="st">&quot;y&quot;</span><span class="op">;</span> <span class="co">// could be &quot;y;z&quot; for variables y and z</span></span>
<span id="cb18-5"><a href="factor-simulation-based-likelihood.html#cb18-5" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<p>R example:</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb19-1"><a href="factor-simulation-based-likelihood.html#cb19-1" tabindex="-1"></a><span class="co">/***data_variable,&quot;y&quot;***/</span></span></code></pre></div>
</div>
<div id="summary_statistics" class="section level3 hasAnchor" number="3.4.3">
<h3><span class="header-section-number">3.4.3</span> summary_statistics<a href="factor-simulation-based-likelihood.html#summary_statistics" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The <code>summary_statistics</code> function type reduces the observed data to summary statistics for use in the simulation-based likelihood. The inclusion of this function type is optional: if it is included, then inference using the simulation-based likelihood will be conditional only on the summary statistics of the data, rather than the full data. If the argument is omitted, the simulation-based likelihood will use the full data.</p>
<p>Input: Simulated/observed data.</p>
<p>– of type <code>const Data &amp;</code> in a C++ function</p>
<p>– available as R list <code>data</code> in an R function</p>
<p>Output: The summary statistics of the data.</p>
<p>– of type <code>const Data &amp;</code> in a C++ function</p>
<p>– available as R list <code>data</code> in an R function</p>
<p>C++ example:</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb20-1"><a href="factor-simulation-based-likelihood.html#cb20-1" tabindex="-1"></a><span class="co">/***summary_statistics***/</span></span>
<span id="cb20-2"><a href="factor-simulation-based-likelihood.html#cb20-2" tabindex="-1"></a>Data summary_statistics<span class="op">(</span><span class="at">const</span> Data <span class="op">&amp;</span>data<span class="op">)</span></span>
<span id="cb20-3"><a href="factor-simulation-based-likelihood.html#cb20-3" tabindex="-1"></a><span class="op">{</span></span>
<span id="cb20-4"><a href="factor-simulation-based-likelihood.html#cb20-4" tabindex="-1"></a>  arma<span class="op">::</span>colvec y <span class="op">=</span> data<span class="op">[</span><span class="st">&quot;y&quot;</span><span class="op">];</span></span>
<span id="cb20-5"><a href="factor-simulation-based-likelihood.html#cb20-5" tabindex="-1"></a>  <span class="cf">return</span> Data<span class="op">(</span><span class="st">&quot;y_mean&quot;</span><span class="op">,</span> arma<span class="op">::</span>mean<span class="op">(</span>y<span class="op">));</span></span>
<span id="cb20-6"><a href="factor-simulation-based-likelihood.html#cb20-6" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<p>R example:</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb21-1"><a href="factor-simulation-based-likelihood.html#cb21-1" tabindex="-1"></a><span class="co">/***summary_statistics,y_mean=mean(data$y)***/</span></span></code></pre></div>
</div>
<div id="sbi_likelihood-ilike-functions" class="section level3 hasAnchor" number="3.4.4">
<h3><span class="header-section-number">3.4.4</span> sbi_likelihood (ilike functions)<a href="factor-simulation-based-likelihood.html#sbi_likelihood-ilike-functions" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The <code>sbi_likelihood</code> function type uses an ilike function to define the desired simulation-based likelihood. For all ilike functions we give the required arguments, stating their required type (using R types). Recall that the input arguments must be specified in the correct order. Some functions have optional arguments, which can only be omitted if arguments following them are also omitted.</p>
<p>Example of the use of one of these functions (<code>ilike::sl</code>) follows.</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb22-1"><a href="factor-simulation-based-likelihood.html#cb22-1" tabindex="-1"></a><span class="co">/***sbi_likelihood,ilike::sl(50)***/</span></span></code></pre></div>
<p>All of these methods use simulations from the data generating process (DGP) to construct an approximate likelihood from data <span class="math inline">\(y_{\mbox{obs}}\)</span>. <span class="math inline">\(s_{\mbox{obs}}\)</span> is used to denote the result of applying the <code>summary_statistic</code> function to <span class="math inline">\(y_{\mbox{obs}}\)</span>. Let <span class="math inline">\(y^{1:M}\)</span> be <span class="math inline">\(M\)</span> draws from the DGP <span class="math inline">\(f(\cdot \mid \theta)\)</span> for parameter <span class="math inline">\(\theta\)</span> and let <span class="math inline">\(s^{1:M}\)</span> be the result of applying the <code>summary_statistic</code> function to each corresponding simulation. Suppose that each summary statistic lies in <span class="math inline">\(\mathbb{R}^{d_s}\)</span>: this vector is the result of stacking the summary statistics named in the <code>data_variable</code> function type.</p>
<p>The available ilike functions are detailed in the following sections.</p>
<div id="sl" class="section level4 hasAnchor" number="3.4.4.1">
<h4><span class="header-section-number">3.4.4.1</span> Synthetic likelihood <code>ilike::sl</code><a href="factor-simulation-based-likelihood.html#sl" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Specifies a synthetic likelihood (SL), as described in <span class="citation">Wood (<a href="#ref-wood2010statistical">2010</a>)</span> and <span class="citation">Price et al. (<a href="#ref-price2018bayesian">2018</a>)</span>. The synthetic likelihood <span class="math inline">\(l(s_{\mbox{obs}} \mid \theta)\)</span> is given by</p>
<p><span class="math display" id="eq:sl">\[
l(s_{\mbox{obs}} \mid \theta) = \mathcal{MVN}\left( s_{\mbox{obs}} \mid \hat{\mu}, \hat{\Sigma} \right),
\tag{3.1}
\]</span> where
<span class="math display" id="eq:slmusigma">\[
\hat{\mu} = \frac{1}{M} \sum_{j=1}^M s^{j} \qquad \hat{\Sigma} = \frac{1}{M-1} \sum_{j=1}^M \left( s^{j} - \hat{\mu} \right) \left( s^{j} - \hat{\mu} \right)^T.
\tag{3.2}
\]</span> <span class="citation">Price et al. (<a href="#ref-price2018bayesian">2018</a>)</span> describes an extended version of this approach, which uses an unbiased estimate of the Gaussian distribution in equation <a href="factor-simulation-based-likelihood.html#eq:sl">(3.1)</a>, also based on <span class="math inline">\(\hat{\mu}\)</span> and <span class="math inline">\(\hat{\Sigma}\)</span> from equation <a href="factor-simulation-based-likelihood.html#eq:slmusigma">(3.2)</a>.</p>
<p>Inputs:</p>
<ol style="list-style-type: decimal">
<li><p>integer: the number of simulations <span class="math inline">\(M\)</span> to use in the synthetic likelihood</p></li>
<li><p>(optional) boolean: whether to use the unbiased version of synthetic likelihood described in <span class="citation">Price et al. (<a href="#ref-price2018bayesian">2018</a>)</span> (default is <code>false</code>)</p></li>
<li><p>(optional) boolean: whether to store the output of the model simulations (default is <code>false</code>)</p></li>
<li><p>(optional) boolean: whether to run the simulations in parallel (default is <code>false</code>)</p></li>
<li><p>(optional) integer: the grain size for parallelisation (default is <code>100000</code>; see <a href="https://oneapi-src.github.io/oneTBB/main/tbb_userguide/Controlling_Chunking_os.html">guidance here</a>)</p></li>
</ol>
</div>
<div id="abc-uniform-kernel-euclidean-distance-ilikeeuclidean_uniform_abc" class="section level4 hasAnchor" number="3.4.4.2">
<h4><span class="header-section-number">3.4.4.2</span> ABC (uniform kernel; Euclidean distance) <code>ilike::euclidean_uniform_abc</code><a href="factor-simulation-based-likelihood.html#abc-uniform-kernel-euclidean-distance-ilikeeuclidean_uniform_abc" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Specifies an approximate Bayesian computation (ABC), using a uniform kernel and Euclidean distance metric, as described in <span class="citation">Sisson, Fan, and Beaumont (<a href="#ref-sisson2018handbook">2018</a>)</span>. The <code>euclidean_uniform_abc</code> likelihood <span class="math inline">\(l(s_{\mbox{obs}} \mid \theta)\)</span> is given, for tolerance level <span class="math inline">\(\epsilon\)</span>, by</p>
<p><span class="math display">\[
l(s_{\mbox{obs}} \mid \theta) = \frac{1}{M}\sum_{j=1}^{M}K_{\epsilon}\left(s_{\text{obs}}\mid s^{j}\right)
\]</span>
where
<span class="math display">\[
K_{\epsilon}\left(s_{\text{obs}}\mid s^{j}\right) = \begin{cases} 1/c &amp; \text{if } d( s_{\mbox{obs}} - s^{j} ) \leq \epsilon \\ 0 &amp; \text{otherwise} \end{cases},
\]</span>
for</p>
<p><span class="math display">\[
c = \frac{2^{d_s}\Gamma\left(\frac{1}{2}+1\right)^{d_s}}{\Gamma\left(\frac{d_s}{2}+1\right)}\epsilon^{d_s}\sum_{i=1}^{d_s}\sigma_{i}
\]</span>
where</p>
<p><span class="math display">\[
d(s_{\text{obs}},s)=\left(\sum_{i=1}^{d_{s}}\left(\frac{s_{\text{obs},i}-s_{i}}{\sigma_{i}}\right)^{2}\right)^{1/2}
\]</span></p>
<p>Here <span class="math inline">\(\sigma_i\)</span> is a scaling used for the <span class="math inline">\(i\)</span>th dimension of <span class="math inline">\(s\)</span>. The value of <span class="math inline">\(c\)</span> is here to ensure that the uniform kernel is normalised, and uses the <a href="https://www.johndcook.com/blog/2010/07/02/volumes-of-generalized-unit-balls/">formula for volume of a <span class="math inline">\(d_s\)</span>-dimensional ball</a>.</p>
<p>Inputs:</p>
<ol style="list-style-type: decimal">
<li><p>integer: the number of simulations <span class="math inline">\(M\)</span> to use in the ABC</p></li>
<li><p>string: the name of the tolerance variable in the ABC</p></li>
<li><p>numeric: the tolerance level for the ABC</p></li>
<li><p>(optional) string: the name of the variable that stores the scaling <span class="math inline">\(\sigma_i\)</span> of the data/summaries in the ABC (default is <code>""</code> - in this case the scale will be <code>1</code> for every dimension)</p></li>
<li><p>(optional) numeric vector: the scaling of the data/summary in the ABC, which must be of the same dimension as the data/summary This is only used if the scale variable (argument 4) is set.</p></li>
<li><p>(optional) boolean: whether to store the output of the model simulations (default is <code>false</code>)</p></li>
<li><p>(optional) boolean: whether to run the simulations in parallel (default is <code>false</code>)</p></li>
<li><p>(optional) integer: the grain size for parallelisation (default is <code>100000</code>; see <a href="https://oneapi-src.github.io/oneTBB/main/tbb_userguide/Controlling_Chunking_os.html">guidance here</a>)</p></li>
</ol>
</div>
<div id="abc-uniform-kernel-lp-distance-ilikelp_uniform_abc" class="section level4 hasAnchor" number="3.4.4.3">
<h4><span class="header-section-number">3.4.4.3</span> ABC (uniform kernel; <span class="math inline">\(L^p\)</span> distance) <code>ilike::lp_uniform_abc</code><a href="factor-simulation-based-likelihood.html#abc-uniform-kernel-lp-distance-ilikelp_uniform_abc" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Specified an approximate Bayesian computation (ABC) likelihood, using a uniform kernel and the <span class="math inline">\(L^p\)</span> distance metric. The <code>lp_uniform_abc</code> likelihood <span class="math inline">\(l(y \mid \theta)\)</span> is given, for tolerance level <span class="math inline">\(\epsilon\)</span>, by</p>
<p><span class="math display">\[
l(s_{\mbox{obs}} \mid \theta) = \frac{1}{M}\sum_{j=1}^{M}K_{\epsilon}\left(s_{\text{obs}}\mid s^{j}\right)
\]</span>
where
<span class="math display">\[
K_{\epsilon}\left(s_{\text{obs}}\mid s^{j}\right) = \begin{cases} 1/c &amp; \text{if } d( s_{\mbox{obs}} - s^{j} ) \leq \epsilon \\ 0 &amp; \text{otherwise} \end{cases},
\]</span>
for</p>
<p><span class="math display">\[
c = \frac{2^{d_s}\Gamma\left(\frac{1}{p}+1\right)^{d_s}}{\Gamma\left(\frac{d_s}{p}+1\right)}\epsilon^{d_s}\sum_{j=1}^{d_s}\sigma_{i}
\]</span>
where</p>
<p><span class="math display">\[
d(s_{\text{obs}},s)=\left(\sum_{i=1}^{d_{s}}\left(\frac{s_{\text{obs},i}-s_{i}}{\sigma_{i}}\right)^{p}\right)^{1/p}
\]</span></p>
<p>Here <span class="math inline">\(\sigma_i\)</span> is a scaling used for the <span class="math inline">\(i\)</span>th dimension of <span class="math inline">\(s\)</span>. The value of <span class="math inline">\(c\)</span> is here to ensure that the uniform kernel is normalised, and uses the <a href="https://www.johndcook.com/blog/2010/07/02/volumes-of-generalized-unit-balls/">formula for volume of a <span class="math inline">\(d_s\)</span>-dimensional ball in <span class="math inline">\(L^p\)</span> space</a>.</p>
<p>Inputs:</p>
<ol style="list-style-type: decimal">
<li><p>integer: the number of simulations <span class="math inline">\(M\)</span> to use in the ABC</p></li>
<li><p>string: the name of the tolerance variable in the ABC</p></li>
<li><p>numeric: the tolerance level for the ABC</p></li>
<li><p>numeric: the value of <span class="math inline">\(p\)</span> for the <span class="math inline">\(L^p\)</span> distance metric</p></li>
<li><p>(optional) string: the name of the variable that stores the scaling <span class="math inline">\(\sigma_i\)</span> of the data/summaries in the ABC (default is <code>""</code> - in this case the scale will be <code>1</code> for every dimension)</p></li>
<li><p>(optional) numeric vector: the scaling of the data/summary in the ABC, which must be of the same dimension as the data/summary This is only used if the scale variable (argument 5) is set.</p></li>
<li><p>(optional) boolean: whether to store the output of the model simulations (default is <code>false</code>)</p></li>
<li><p>(optional) boolean: whether to run the simulations in parallel (default is <code>false</code>)</p></li>
<li><p>(optional) integer: the grain size for parallelisation (default is <code>100000</code>; see <a href="https://oneapi-src.github.io/oneTBB/main/tbb_userguide/Controlling_Chunking_os.html">guidance here</a>)</p></li>
</ol>
</div>
<div id="gaussian-abc" class="section level4 hasAnchor" number="3.4.4.4">
<h4><span class="header-section-number">3.4.4.4</span> ABC (Gaussian kernel) <code>ilike::gaussian_abc</code><a href="factor-simulation-based-likelihood.html#gaussian-abc" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Specifies an approximate Bayesian computation (ABC) likelihood, using a Gaussian kernel. The <code>gaussian_abc</code> likelihood <span class="math inline">\(l(s_{\mbox{obs}} \mid \theta)\)</span> is given, for tolerance level <span class="math inline">\(\epsilon\)</span>, by</p>
<p><span class="math display">\[
l(s_{\mbox{obs}} \mid \theta) = \frac{1}{M}\sum_{j=1}^{M}K_{\epsilon}\left(s_{\text{obs}}\mid s^{j}\right)
\]</span>
where
<span class="math display">\[
K_{\epsilon}\left(s_{\text{obs}}\mid s^{j}\right) = \left(2\pi\epsilon\right)^{-d_{y}/2}\prod_{i=1}^{d_{s}}\frac{1}{\sigma_{i}^{2}}\exp\left(-\frac{1}{2\epsilon^{2}}\sum_{i=1}^{d_{s}}\left(\frac{s_{\text{obs},i}-s_{i}}{\sigma_{i}}\right)^{2}\right).
\]</span>
Here <span class="math inline">\(\sigma_i\)</span> is a scaling used for the <span class="math inline">\(i\)</span>th dimension of <span class="math inline">\(s\)</span>.</p>
<p>Inputs:</p>
<ol style="list-style-type: decimal">
<li><p>integer: the number of simulations <span class="math inline">\(M\)</span> to use in the ABC</p></li>
<li><p>string: the name of the tolerance variable in the ABC</p></li>
<li><p>numeric: the tolerance level for the ABC</p></li>
<li><p>(optional) string: the name of the variable that stores the scaling <span class="math inline">\(\sigma_i\)</span> of the data/summaries in the ABC (default is <code>""</code> - in this case the scale will be <code>1</code> for every dimension)</p></li>
<li><p>(optional) numeric vector: the scaling of the data/summary in the ABC, which must be of the same dimension as the data/summary This is only used if the scale variable (argument 4) is set.</p></li>
<li><p>(optional) boolean: whether to store the output of the model simulations (default is <code>false</code>)</p></li>
<li><p>(optional) boolean: whether to run the simulations in parallel (default is <code>false</code>)</p></li>
<li><p>(optional) integer: the grain size for parallelisation (default is <code>100000</code>; see <a href="https://oneapi-src.github.io/oneTBB/main/tbb_userguide/Controlling_Chunking_os.html">guidance here</a>)</p></li>
</ol>
</div>
<div id="ienki-abc-ilikeienki_abc" class="section level4 hasAnchor" number="3.4.4.5">
<h4><span class="header-section-number">3.4.4.5</span> IEnKI-ABC <code>ilike::ienki_abc</code><a href="factor-simulation-based-likelihood.html#ienki-abc-ilikeienki_abc" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Specifies an approximate Bayesian computation (ABC) likelihood, estimating using iterative ensemble Kalman inversion (IEnKI), as described in <span class="citation">Everitt (<a href="#ref-everitt2024ensemble">2024</a>)</span>. This approach uses an alternative estimator for the ABC likelihood using the Gaussian kernel, with tolerance <span class="math inline">\(\epsilon\)</span>, described in section <a href="factor-simulation-based-likelihood.html#gaussian-abc">3.4.4.4</a>. IEnKI uses an ensemble of points to simulate from a sequence of <span class="math inline">\(0:T\)</span> distributions using a decreasing sequence of tolerances <span class="math inline">\(\infty = \epsilon_0 &gt; .... &gt; \epsilon_T = \epsilon\)</span>. The 0th distrbution is <span class="math inline">\(f_s( s \mid \theta)\)</span> (corresponding to the case where <span class="math inline">\(\epsilon=\infty\)</span>), where <span class="math inline">\(f_s\)</span> is the distribution resulting from the data generating process <span class="math inline">\(f( \cdot \mid \theta)\)</span> and the summary statistic transformation. The <span class="math inline">\(t\)</span>th distribution for <span class="math inline">\(t&gt;0\)</span> is <span class="math inline">\(f_s( s \mid \theta) K_{\epsilon_t}\left(s_{\text{obs}}\mid s\right)\)</span>. The estimator of the normalising constant of the final target distribution, constructed using the ensemble at each step of the IEnKI, is an estimator of the ABC likelihood. This estimator is biased in general, but is likely to have significantly lower variance than that from standard ABC. When the final <span class="math inline">\(\epsilon\)</span> is taken to be zero, and <span class="math inline">\(T=1\)</span>, the estimator is the same as that used in synthetic likelihood (section <a href="factor-simulation-based-likelihood.html#sl">3.4.4.1</a>). Full details can be found in <span class="citation">Everitt (<a href="#ref-everitt2024ensemble">2024</a>)</span>.</p>
<p>Inputs:</p>
<ol style="list-style-type: decimal">
<li><p>integer: the number of ensemble members <span class="math inline">\(M\)</span> to use in the IEnKI-ABC</p></li>
<li><p>integer: the estimator type constructed from the IEnKI output. The meaning of each of the four options below is given in the paper <span class="citation">Everitt (<a href="#ref-everitt2024ensemble">2024</a>)</span>. The options are:</p></li>
</ol>
<ul>
<li><p><code>1</code> (recommended): the “direct” estimator</p></li>
<li><p><code>2</code>: the “unbiased” estimator, using the approach analogous to the unbiased method in <span class="citation">Price et al. (<a href="#ref-price2018bayesian">2018</a>)</span></p></li>
<li><p><code>3</code>: the path sampling estimator</p></li>
<li><p><code>4</code>: the alternative path sampling estimator from <span class="citation">Friel, Hurn, and Wyse (<a href="#ref-friel2014improving">2014</a>)</span></p></li>
</ul>
<ol start="3" style="list-style-type: decimal">
<li><p>string: the name of the tolerance variable in the ABC</p></li>
<li><p>numeric: the tolerance level for the ABC</p></li>
<li><p>string: the shifter used in the IEnKI (the method for moving the ensemble at each iteration). The options are:</p></li>
</ol>
<ul>
<li><p><code>stochastic</code> (recommended): the stochastic shifter</p></li>
<li><p><code>sqrt</code>: the square root shifter</p></li>
<li><p><code>adjustment</code>: the adjustment shifter</p></li>
</ul>
<ol start="6" style="list-style-type: decimal">
<li><p>integer: the number of targets <span class="math inline">\(T\)</span> used in the IEnKI</p></li>
<li><p>(optional) numeric: the significance level for the significance test used in determining when to use the target skipping approach proposed in <span class="citation">Everitt (<a href="#ref-everitt2024ensemble">2024</a>)</span> (default is <code>1</code>, which results in skipping no targets; <code>0.1</code> recommended when using the stochastic shifter)</p></li>
<li><p>(optional) integer: the number of iterations of output of each run of the IEnKI to store, counting from the final iteration backwards (default is <code>0</code>)</p></li>
<li><p>(optional) string: the name of the variable that stores the scaling <span class="math inline">\(\sigma_i\)</span> of the data/summaries in the ABC (default is <code>""</code> - in this case the scale will be <code>1</code> for every dimension)</p></li>
<li><p>(optional) numeric vector: the scaling of the data/summary in the ABC, which must be of the same dimension as the data/summary This is only used if the scale variable (argument 5) is set.</p></li>
<li><p>(optional) boolean: whether to perform the IEnKI on the summary statistic space (default is <code>true</code>; <code>false</code> is largely untested)</p></li>
<li><p>(optional) boolean: whether to run the simulations in parallel (default is <code>false</code>)</p></li>
<li><p>(optional) integer: the grain size for parallelisation (default is <code>100000</code>; see <a href="https://oneapi-src.github.io/oneTBB/main/tbb_userguide/Controlling_Chunking_os.html">guidance here</a>)</p></li>
</ol>
</div>
</div>
</div>
<h3>References<a href="references.html#references" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div id="ref-everitt2024ensemble" class="csl-entry">
Everitt, Richard G. 2024. <span>“Ensemble Kalman Inversion Approximate Bayesian Computation.”</span> <em>arXiv Preprint arXiv:2407.18721</em>.
</div>
<div id="ref-friel2014improving" class="csl-entry">
Friel, Nial, Merrilee Hurn, and Jason Wyse. 2014. <span>“Improving Power Posterior Estimation of Statistical Evidence.”</span> <em>Statistics and Computing</em> 24: 709–23.
</div>
<div id="ref-price2018bayesian" class="csl-entry">
Price, Leah F, Christopher C Drovandi, Anthony Lee, and David J Nott. 2018. <span>“Bayesian Synthetic Likelihood.”</span> <em>Journal of Computational and Graphical Statistics</em> 27 (1): 1–11.
</div>
<div id="ref-sisson2018handbook" class="csl-entry">
Sisson, Scott A, Yanan Fan, and Mark Beaumont. 2018. <em>Handbook of Approximate <span>B</span>ayesian Computation</em>. CRC press.
</div>
<div id="ref-wood2010statistical" class="csl-entry">
Wood, Simon N. 2010. <span>“Statistical Inference for Noisy Nonlinear Ecological Dynamic Systems.”</span> <em>Nature</em> 466 (7310): 1102–4.
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="factor-custom-likelihood.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="factor-linear-gaussian-model.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/richardgeveritt/ilike_documentation/edit/master/02-models.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["ilike docs.pdf", "ilike docs.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>

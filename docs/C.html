<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>2.3 C++ functions | ilike documentation</title>
  <meta name="description" content="Documentation for the ilike R package." />
  <meta name="generator" content="bookdown 0.37 and GitBook 2.6.7" />

  <meta property="og:title" content="2.3 C++ functions | ilike documentation" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="Documentation for the ilike R package." />
  <meta name="github-repo" content="richardgeveritt/ilike_documentation" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="2.3 C++ functions | ilike documentation" />
  
  <meta name="twitter:description" content="Documentation for the ilike R package." />
  

<meta name="author" content="Richard G. Everitt" />


<meta name="date" content="2024-09-25" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="compiling.html"/>
<link rel="next" href="R.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>
<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">ilike documentation</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Preface</a>
<ul>
<li class="chapter" data-level="1.1" data-path="toy-example.html"><a href="toy-example.html"><i class="fa fa-check"></i><b>1.1</b> Example</a>
<ul>
<li class="chapter" data-level="1.1.1" data-path="toy-example.html"><a href="toy-example.html#model"><i class="fa fa-check"></i><b>1.1.1</b> Model</a></li>
<li class="chapter" data-level="1.1.2" data-path="toy-example.html"><a href="toy-example.html#ilike-file"><i class="fa fa-check"></i><b>1.1.2</b> ilike file</a></li>
<li class="chapter" data-level="1.1.3" data-path="toy-example.html"><a href="toy-example.html#running-mcmc"><i class="fa fa-check"></i><b>1.1.3</b> Running MCMC</a></li>
<li class="chapter" data-level="1.1.4" data-path="toy-example.html"><a href="toy-example.html#visualising-the-output"><i class="fa fa-check"></i><b>1.1.4</b> Visualising the output</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="ilike-files.html"><a href="ilike-files.html"><i class="fa fa-check"></i><b>2</b> ilike files</a>
<ul>
<li class="chapter" data-level="2.1" data-path="file-structure.html"><a href="file-structure.html"><i class="fa fa-check"></i><b>2.1</b> File structure</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="file-structure.html"><a href="file-structure.html#blocks-automatically"><i class="fa fa-check"></i><b>2.1.1</b> Specifying blocks automatically</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="compiling.html"><a href="compiling.html"><i class="fa fa-check"></i><b>2.2</b> Compiling an ilike file</a></li>
<li class="chapter" data-level="2.3" data-path="C.html"><a href="C.html"><i class="fa fa-check"></i><b>2.3</b> C++ functions</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="C.html"><a href="C.html#including-additional-code"><i class="fa fa-check"></i><b>2.3.1</b> Including additional code</a></li>
<li class="chapter" data-level="2.3.2" data-path="C.html"><a href="C.html#ilike-cpp-classes"><i class="fa fa-check"></i><b>2.3.2</b> ilike C++ classes</a></li>
<li class="chapter" data-level="2.3.3" data-path="C.html"><a href="C.html#ilike-cpp-functions"><i class="fa fa-check"></i><b>2.3.3</b> ilike C++ functions</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="R.html"><a href="R.html"><i class="fa fa-check"></i><b>2.4</b> R functions</a></li>
<li class="chapter" data-level="2.5" data-path="python.html"><a href="python.html"><i class="fa fa-check"></i><b>2.5</b> python functions</a></li>
<li class="chapter" data-level="2.6" data-path="julia.html"><a href="julia.html"><i class="fa fa-check"></i><b>2.6</b> julia functions</a></li>
<li class="chapter" data-level="2.7" data-path="ilike-functions.html"><a href="ilike-functions.html"><i class="fa fa-check"></i><b>2.7</b> ilike functions</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="blocks.html"><a href="blocks.html"><i class="fa fa-check"></i><b>3</b> ilike blocks</a>
<ul>
<li class="chapter" data-level="3.1" data-path="data.html"><a href="data.html"><i class="fa fa-check"></i><b>3.1</b> Data</a></li>
<li class="chapter" data-level="3.2" data-path="priors.html"><a href="priors.html"><i class="fa fa-check"></i><b>3.2</b> Priors</a></li>
<li class="chapter" data-level="3.3" data-path="likelihoods.html"><a href="likelihoods.html"><i class="fa fa-check"></i><b>3.3</b> Likelihoods</a></li>
<li class="chapter" data-level="3.4" data-path="importance-sampling-proposals.html"><a href="importance-sampling-proposals.html"><i class="fa fa-check"></i><b>3.4</b> Importance sampling proposals</a></li>
<li class="chapter" data-level="3.5" data-path="mcmc-proposals.html"><a href="mcmc-proposals.html"><i class="fa fa-check"></i><b>3.5</b> MCMC proposals</a></li>
<li class="chapter" data-level="3.6" data-path="transition-model.html"><a href="transition-model.html"><i class="fa fa-check"></i><b>3.6</b> Transition model</a></li>
<li class="chapter" data-level="3.7" data-path="filter.html"><a href="filter.html"><i class="fa fa-check"></i><b>3.7</b> Filter</a></li>
<li class="chapter" data-level="3.8" data-path="gradient.html"><a href="gradient.html"><i class="fa fa-check"></i><b>3.8</b> Gradient</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="inference.html"><a href="inference.html"><i class="fa fa-check"></i><b>4</b> Inference algorithms</a>
<ul>
<li class="chapter" data-level="4.1" data-path="random-numbers.html"><a href="random-numbers.html"><i class="fa fa-check"></i><b>4.1</b> Random numbers</a></li>
<li class="chapter" data-level="4.2" data-path="parameters.html"><a href="parameters.html"><i class="fa fa-check"></i><b>4.2</b> Model and algorithm parameters</a></li>
<li class="chapter" data-level="4.3" data-path="importance-sampling.html"><a href="importance-sampling.html"><i class="fa fa-check"></i><b>4.3</b> Importance sampling</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="importance-sampling.html"><a href="importance-sampling.html#ilike-file-requirements"><i class="fa fa-check"></i><b>4.3.1</b> .ilike file requirements</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html"><i class="fa fa-check"></i><b>4.4</b> Markov chain Monte Carlo</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#ilike-file-requirements-1"><i class="fa fa-check"></i><b>4.4.1</b> .ilike file requirements</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="sequential-monte-carlo.html"><a href="sequential-monte-carlo.html"><i class="fa fa-check"></i><b>4.5</b> Sequential Monte Carlo</a>
<ul>
<li class="chapter" data-level="4.5.1" data-path="sequential-monte-carlo.html"><a href="sequential-monte-carlo.html#ilike-file-requirements-2"><i class="fa fa-check"></i><b>4.5.1</b> .ilike file requirements</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="iterative-ensemble-kalman-inversion.html"><a href="iterative-ensemble-kalman-inversion.html"><i class="fa fa-check"></i><b>4.6</b> Iterative ensemble Kalman inversion</a>
<ul>
<li class="chapter" data-level="4.6.1" data-path="iterative-ensemble-kalman-inversion.html"><a href="iterative-ensemble-kalman-inversion.html#ilike-file-requirements-3"><i class="fa fa-check"></i><b>4.6.1</b> .ilike file requirements</a></li>
</ul></li>
<li class="chapter" data-level="4.7" data-path="particle-filters.html"><a href="particle-filters.html"><i class="fa fa-check"></i><b>4.7</b> Particle filters</a>
<ul>
<li class="chapter" data-level="4.7.1" data-path="particle-filters.html"><a href="particle-filters.html#ilike-file-requirements-4"><i class="fa fa-check"></i><b>4.7.1</b> .ilike file requirements</a></li>
</ul></li>
<li class="chapter" data-level="4.8" data-path="ensemble-kalman-filters.html"><a href="ensemble-kalman-filters.html"><i class="fa fa-check"></i><b>4.8</b> Ensemble Kalman filters</a>
<ul>
<li class="chapter" data-level="4.8.1" data-path="ensemble-kalman-filters.html"><a href="ensemble-kalman-filters.html#ilike-file-requirements-5"><i class="fa fa-check"></i><b>4.8.1</b> .ilike file requirements</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="output.html"><a href="output.html"><i class="fa fa-check"></i><b>5</b> Loading and visualising output</a>
<ul>
<li class="chapter" data-level="5.1" data-path="is-and-smc-output.html"><a href="is-and-smc-output.html"><i class="fa fa-check"></i><b>5.1</b> IS and SMC output</a></li>
<li class="chapter" data-level="5.2" data-path="ensemble-kalman-output.html"><a href="ensemble-kalman-output.html"><i class="fa fa-check"></i><b>5.2</b> Ensemble Kalman output</a></li>
<li class="chapter" data-level="5.3" data-path="mcmc-output.html"><a href="mcmc-output.html"><i class="fa fa-check"></i><b>5.3</b> MCMC output</a></li>
<li class="chapter" data-level="5.4" data-path="further-detail-about-output-files.html"><a href="further-detail-about-output-files.html"><i class="fa fa-check"></i><b>5.4</b> Further detail about output files</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="examples.html"><a href="examples.html"><i class="fa fa-check"></i><b>6</b> Examples</a>
<ul>
<li class="chapter" data-level="6.1" data-path="running-code.html"><a href="running-code.html"><i class="fa fa-check"></i><b>6.1</b> Running code</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="bugs.html"><a href="bugs.html"><i class="fa fa-check"></i><b>7</b> Known issues and glaring omissions</a>
<ul>
<li class="chapter" data-level="7.1" data-path="known-issues.html"><a href="known-issues.html"><i class="fa fa-check"></i><b>7.1</b> Known issues</a></li>
<li class="chapter" data-level="7.2" data-path="glaring-omissions.html"><a href="glaring-omissions.html"><i class="fa fa-check"></i><b>7.2</b> Glaring omissions</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">ilike documentation</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="C" class="section level2 hasAnchor" number="2.3">
<h2><span class="header-section-number">2.3</span> C++ functions<a href="C.html#C" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>ilike inference will be most computationally efficient if the functions are specified in C++ (or in the native ilike functions in section (ilike-functions)). The interface is designed with the aim that it is possible to use C++ functions for users with a range of different backgrounds: from those who know relatively little C++ (for whom R-like functions are provided to facilitate the process); to those who have an existing C++ code base that they would like to use to, for example, define a simulator-based model.</p>
<p>We have already seen an example of C++ functions in section (toy-example). Here is the <code>evaluate_log_prior</code> function from that example.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb3-1"><a href="C.html#cb3-1" tabindex="-1"></a><span class="co">/***evaluate_log_prior***/</span></span>
<span id="cb3-2"><a href="C.html#cb3-2" tabindex="-1"></a><span class="dt">double</span> prior_eval<span class="op">(</span><span class="at">const</span> Parameters <span class="op">&amp;</span>parameters<span class="op">)</span></span>
<span id="cb3-3"><a href="C.html#cb3-3" tabindex="-1"></a><span class="op">{</span></span>
<span id="cb3-4"><a href="C.html#cb3-4" tabindex="-1"></a>  arma<span class="op">::</span>colvec θ <span class="op">=</span> parameters<span class="op">[</span><span class="st">&quot;θ&quot;</span><span class="op">];</span></span>
<span id="cb3-5"><a href="C.html#cb3-5" tabindex="-1"></a>  <span class="cf">return</span> dnorm<span class="op">(</span>θ<span class="op">[</span><span class="dv">0</span><span class="op">],</span><span class="fl">0.0</span><span class="op">,</span><span class="fl">10.0</span><span class="op">)</span> <span class="op">+</span> dnorm<span class="op">(</span>θ<span class="op">[</span><span class="dv">1</span><span class="op">],</span><span class="fl">0.0</span><span class="op">,</span><span class="fl">10.0</span><span class="op">);</span></span>
<span id="cb3-6"><a href="C.html#cb3-6" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<p>If you are not familiar with C++, I imagine the main thing that looks odd to you here is the “types”, i.e. <code>double</code>, <code>Parameters</code> and <code>arma::colvec</code>. C++ is a typed language. In R we might write <code>x = 1</code> (or probably more correctly, although I never can get into this habit myself, <code>x&lt;-1</code>), and then R works out that the <code>1</code> that it will store in <code>x</code> is a numeric type. This is invisible from the user, until for example you want to use a function that needs to take, say, a data frame, and the variable is stored as a matrix (in which case as.data_frame(…) is handy). In C++, these types must be explicitly specified in the code. We would write, for example, <code>double x = 1.0;</code> to specify that <code>x</code> has the numeric type <code>double</code>. Note that C++ also requires a semi-colon at the end of each line.</p>
<p>There are several points that are worth highlighting about this function:</p>
<ul>
<li><p>The name of the function can be anything you like.</p></li>
<li><p>It is a standard C++ function that, independently of being compiled by ilike would compile using a C++ compiler if all of the correct header files are included<a href="#fn3" class="footnote-ref" id="fnref3"><sup>3</sup></a>.</p></li>
<li><p>It has a return type (<code>double</code>) and argument(s) (<code>const Parameters &amp;</code>)<a href="#fn4" class="footnote-ref" id="fnref4"><sup>4</sup></a> that are pre-determined by the ilike package. The key point is that if a function under the <code>evaluate_log_prior</code> type does not have this return type and arguments (including the <code>const</code> and the <code>&amp;</code>), you will receive an error.</p></li>
<li><p>The type <code>Parameters</code> is a class defined in the ilike package source. It operates in a similar way to an R list, or a python dictionary. There are more details about this in section (ilike-cpp-classes).</p></li>
<li><p>arma::colvec is vector type found in the <a href="https://arma.sourceforge.net/docs.html">armadillo</a> library. Any functions written to be compiled in ilike have access to this library courtesy of the R package <code>RcppArmadillo</code> <span class="citation">(<a href="#ref-eddelbuettel2014rcpparmadillo">Eddelbuettel and Sanderson 2014</a>)</span>. Parameter vectors are stored in the <code>Parameters</code> classes using armadillo matrices.</p></li>
<li><p>The function <code>dnorm</code> is an C++ function provided in the ilike package for use in ilike files (or for anyone writing <code>Rcpp</code> code). More details about these functions can be found in section (ilike-cpp-functions).</p></li>
</ul>
<p>In conclusion, to write a C++ function in an ilike file:</p>
<ol style="list-style-type: decimal">
<li><p>Write the header above the function.</p></li>
<li><p>Write the C++ function with the return type and arguments required for that function type, using ilike C++ functions to help you if you need.</p></li>
</ol>
<div id="including-additional-code" class="section level3 hasAnchor" number="2.3.1">
<h3><span class="header-section-number">2.3.1</span> Including additional code<a href="C.html#including-additional-code" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>For anything beyond a simple model, writing all of the implementation of, say, a likelihood, within a single C++ function is quite constraining. Fortunately an ilike file gives you more flexibility than this. As an example, consider an altered version of the beginning of the ilike file from section (toy-example), in which we have added a <code>simulate_prior</code> function to go with the <code>evaluate_log_prior</code> function.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb4-1"><a href="C.html#cb4-1" tabindex="-1"></a><span class="co">/***data,y=get_data()***/</span></span>
<span id="cb4-2"><a href="C.html#cb4-2" tabindex="-1"></a>  </span>
<span id="cb4-3"><a href="C.html#cb4-3" tabindex="-1"></a><span class="co">/***evaluate_log_prior***/</span></span>
<span id="cb4-4"><a href="C.html#cb4-4" tabindex="-1"></a><span class="dt">double</span> prior_eval<span class="op">(</span><span class="at">const</span> Parameters <span class="op">&amp;</span>parameters<span class="op">)</span></span>
<span id="cb4-5"><a href="C.html#cb4-5" tabindex="-1"></a><span class="op">{</span></span>
<span id="cb4-6"><a href="C.html#cb4-6" tabindex="-1"></a>  <span class="dt">double</span> prior_mean <span class="op">=</span> <span class="fl">0.0</span><span class="op">;</span></span>
<span id="cb4-7"><a href="C.html#cb4-7" tabindex="-1"></a>  <span class="dt">double</span> prior_sd <span class="op">=</span> <span class="fl">10.0</span><span class="op">;</span></span>
<span id="cb4-8"><a href="C.html#cb4-8" tabindex="-1"></a>  arma<span class="op">::</span>colvec θ <span class="op">=</span> parameters<span class="op">[</span><span class="st">&quot;θ&quot;</span><span class="op">];</span></span>
<span id="cb4-9"><a href="C.html#cb4-9" tabindex="-1"></a>  <span class="cf">return</span> dnorm<span class="op">(</span>θ<span class="op">[</span><span class="dv">0</span><span class="op">],</span>prior_mean<span class="op">,</span>prior_sd<span class="op">)</span> <span class="op">+</span> dnorm<span class="op">(</span>θ<span class="op">[</span><span class="dv">1</span><span class="op">],</span>prior_mean<span class="op">,</span>prior_sd<span class="op">);</span></span>
<span id="cb4-10"><a href="C.html#cb4-10" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb4-11"><a href="C.html#cb4-11" tabindex="-1"></a></span>
<span id="cb4-12"><a href="C.html#cb4-12" tabindex="-1"></a><span class="co">/***simulate_prior***/</span></span>
<span id="cb4-13"><a href="C.html#cb4-13" tabindex="-1"></a>Parameters prior_sim<span class="op">(</span>RandomNumberGenerator <span class="op">&amp;</span>rng<span class="op">)</span></span>
<span id="cb4-14"><a href="C.html#cb4-14" tabindex="-1"></a><span class="op">{</span></span>
<span id="cb4-15"><a href="C.html#cb4-15" tabindex="-1"></a>  <span class="dt">double</span> prior_mean <span class="op">=</span> <span class="fl">0.0</span><span class="op">;</span></span>
<span id="cb4-16"><a href="C.html#cb4-16" tabindex="-1"></a>  <span class="dt">double</span> prior_sd <span class="op">=</span> <span class="fl">10.0</span><span class="op">;</span></span>
<span id="cb4-17"><a href="C.html#cb4-17" tabindex="-1"></a>  arma<span class="op">::</span>colvec simulated<span class="op">(</span><span class="dv">2</span><span class="op">);</span></span>
<span id="cb4-18"><a href="C.html#cb4-18" tabindex="-1"></a>  simulated<span class="op">[</span><span class="dv">0</span><span class="op">]</span> <span class="op">=</span> rnorm<span class="op">(</span>prior_mean<span class="op">,</span>prior_sd<span class="op">);</span></span>
<span id="cb4-19"><a href="C.html#cb4-19" tabindex="-1"></a>  simulated<span class="op">[</span><span class="dv">1</span><span class="op">]</span> <span class="op">=</span> rnorm<span class="op">(</span>prior_mean<span class="op">,</span>prior_sd<span class="op">);</span></span>
<span id="cb4-20"><a href="C.html#cb4-20" tabindex="-1"></a>  <span class="cf">return</span> Parameters<span class="op">(</span><span class="st">&quot;θ&quot;</span><span class="op">,</span>simulated<span class="op">);</span></span>
<span id="cb4-21"><a href="C.html#cb4-21" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<p>In both of the functions we have set the variables <code>prior_mean</code> and <code>prior_sd</code>. It is easy to imagine that we might want to try out different prior distributions by changing the mean and/or the standard deviation, but it is just as easy to imagine that we might forget to make the change in <em>both</em> functions. One way we could get around this would be to specify <code>prior_mean</code> and <code>prior_sd</code> to be global variables. To do this in ilike files, you simply need to write these lines of code before any ilike functions (i.e. those with the header lines) in the file. The amended code would look like this:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb5-1"><a href="C.html#cb5-1" tabindex="-1"></a><span class="dt">double</span> prior_mean <span class="op">=</span> <span class="fl">0.0</span><span class="op">;</span></span>
<span id="cb5-2"><a href="C.html#cb5-2" tabindex="-1"></a><span class="dt">double</span> prior_sd <span class="op">=</span> <span class="fl">10.0</span><span class="op">;</span></span>
<span id="cb5-3"><a href="C.html#cb5-3" tabindex="-1"></a></span>
<span id="cb5-4"><a href="C.html#cb5-4" tabindex="-1"></a><span class="co">/***data,y=get_data()***/</span></span>
<span id="cb5-5"><a href="C.html#cb5-5" tabindex="-1"></a>  </span>
<span id="cb5-6"><a href="C.html#cb5-6" tabindex="-1"></a><span class="co">/***evaluate_log_prior***/</span></span>
<span id="cb5-7"><a href="C.html#cb5-7" tabindex="-1"></a><span class="dt">double</span> prior_eval<span class="op">(</span><span class="at">const</span> Parameters <span class="op">&amp;</span>parameters<span class="op">)</span></span>
<span id="cb5-8"><a href="C.html#cb5-8" tabindex="-1"></a><span class="op">{</span></span>
<span id="cb5-9"><a href="C.html#cb5-9" tabindex="-1"></a>  arma<span class="op">::</span>colvec θ <span class="op">=</span> parameters<span class="op">[</span><span class="st">&quot;θ&quot;</span><span class="op">];</span></span>
<span id="cb5-10"><a href="C.html#cb5-10" tabindex="-1"></a>  <span class="cf">return</span> dnorm<span class="op">(</span>θ<span class="op">[</span><span class="dv">0</span><span class="op">],</span>prior_mean<span class="op">,</span>prior_sd<span class="op">)</span> <span class="op">+</span> dnorm<span class="op">(</span>θ<span class="op">[</span><span class="dv">1</span><span class="op">],</span>prior_mean<span class="op">,</span>prior_sd<span class="op">);</span></span>
<span id="cb5-11"><a href="C.html#cb5-11" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb5-12"><a href="C.html#cb5-12" tabindex="-1"></a></span>
<span id="cb5-13"><a href="C.html#cb5-13" tabindex="-1"></a><span class="co">/***simulate_prior***/</span></span>
<span id="cb5-14"><a href="C.html#cb5-14" tabindex="-1"></a>Parameters prior_sim<span class="op">(</span>RandomNumberGenerator <span class="op">&amp;</span>rng<span class="op">)</span></span>
<span id="cb5-15"><a href="C.html#cb5-15" tabindex="-1"></a><span class="op">{</span></span>
<span id="cb5-16"><a href="C.html#cb5-16" tabindex="-1"></a>  arma<span class="op">::</span>colvec simulated<span class="op">(</span><span class="dv">2</span><span class="op">);</span></span>
<span id="cb5-17"><a href="C.html#cb5-17" tabindex="-1"></a>  simulated<span class="op">[</span><span class="dv">0</span><span class="op">]</span> <span class="op">=</span> rnorm<span class="op">(</span>prior_mean<span class="op">,</span>prior_sd<span class="op">);</span></span>
<span id="cb5-18"><a href="C.html#cb5-18" tabindex="-1"></a>  simulated<span class="op">[</span><span class="dv">1</span><span class="op">]</span> <span class="op">=</span> rnorm<span class="op">(</span>prior_mean<span class="op">,</span>prior_sd<span class="op">);</span></span>
<span id="cb5-19"><a href="C.html#cb5-19" tabindex="-1"></a>  <span class="cf">return</span> Parameters<span class="op">(</span><span class="st">&quot;θ&quot;</span><span class="op">,</span>simulated<span class="op">);</span></span>
<span id="cb5-20"><a href="C.html#cb5-20" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<p>Further, ilike can also use variables or functions defined in a C++ header file, where it is <code>#include</code>d before the ilike functions. So the code could be changed to be:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb6-1"><a href="C.html#cb6-1" tabindex="-1"></a><span class="pp">#include </span><span class="im">&quot;priors.h&quot;</span></span>
<span id="cb6-2"><a href="C.html#cb6-2" tabindex="-1"></a></span>
<span id="cb6-3"><a href="C.html#cb6-3" tabindex="-1"></a><span class="co">/***data,y=get_data()***/</span></span>
<span id="cb6-4"><a href="C.html#cb6-4" tabindex="-1"></a>  </span>
<span id="cb6-5"><a href="C.html#cb6-5" tabindex="-1"></a><span class="co">/***evaluate_log_prior***/</span></span>
<span id="cb6-6"><a href="C.html#cb6-6" tabindex="-1"></a><span class="dt">double</span> prior_eval<span class="op">(</span><span class="at">const</span> Parameters <span class="op">&amp;</span>parameters<span class="op">)</span></span>
<span id="cb6-7"><a href="C.html#cb6-7" tabindex="-1"></a><span class="op">{</span></span>
<span id="cb6-8"><a href="C.html#cb6-8" tabindex="-1"></a>  arma<span class="op">::</span>colvec θ <span class="op">=</span> parameters<span class="op">[</span><span class="st">&quot;θ&quot;</span><span class="op">];</span></span>
<span id="cb6-9"><a href="C.html#cb6-9" tabindex="-1"></a>  <span class="cf">return</span> dnorm<span class="op">(</span>θ<span class="op">[</span><span class="dv">0</span><span class="op">],</span>prior_mean<span class="op">,</span>prior_sd<span class="op">)</span> <span class="op">+</span> dnorm<span class="op">(</span>θ<span class="op">[</span><span class="dv">1</span><span class="op">],</span>prior_mean<span class="op">,</span>prior_sd<span class="op">);</span></span>
<span id="cb6-10"><a href="C.html#cb6-10" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb6-11"><a href="C.html#cb6-11" tabindex="-1"></a></span>
<span id="cb6-12"><a href="C.html#cb6-12" tabindex="-1"></a><span class="co">/***simulate_prior***/</span></span>
<span id="cb6-13"><a href="C.html#cb6-13" tabindex="-1"></a>Parameters prior_sim<span class="op">(</span>RandomNumberGenerator <span class="op">&amp;</span>rng<span class="op">)</span></span>
<span id="cb6-14"><a href="C.html#cb6-14" tabindex="-1"></a><span class="op">{</span></span>
<span id="cb6-15"><a href="C.html#cb6-15" tabindex="-1"></a>  arma<span class="op">::</span>colvec simulated<span class="op">(</span><span class="dv">2</span><span class="op">);</span></span>
<span id="cb6-16"><a href="C.html#cb6-16" tabindex="-1"></a>  simulated<span class="op">[</span><span class="dv">0</span><span class="op">]</span> <span class="op">=</span> rnorm<span class="op">(</span>prior_mean<span class="op">,</span>prior_sd<span class="op">);</span></span>
<span id="cb6-17"><a href="C.html#cb6-17" tabindex="-1"></a>  simulated<span class="op">[</span><span class="dv">1</span><span class="op">]</span> <span class="op">=</span> rnorm<span class="op">(</span>prior_mean<span class="op">,</span>prior_sd<span class="op">);</span></span>
<span id="cb6-18"><a href="C.html#cb6-18" tabindex="-1"></a>  <span class="cf">return</span> Parameters<span class="op">(</span><span class="st">&quot;θ&quot;</span><span class="op">,</span>simulated<span class="op">);</span></span>
<span id="cb6-19"><a href="C.html#cb6-19" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<p>where the file <code>priors.h</code> is in the working directory and contains</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb7-1"><a href="C.html#cb7-1" tabindex="-1"></a><span class="dt">double</span> prior_mean <span class="op">=</span> <span class="fl">0.0</span><span class="op">;</span></span>
<span id="cb7-2"><a href="C.html#cb7-2" tabindex="-1"></a><span class="dt">double</span> prior_sd <span class="op">=</span> <span class="fl">10.0</span><span class="op">;</span></span></code></pre></div>
</div>
<div id="ilike-cpp-classes" class="section level3 hasAnchor" number="2.3.2">
<h3><span class="header-section-number">2.3.2</span> ilike C++ classes<a href="C.html#ilike-cpp-classes" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The ilike package contains one class <code>RandomNumberGenerator</code> used for generating random numbers, and two classes, <code>Parameters</code> and <code>Data</code>, which are used to pass parameters and data to and from the ilike inference engine. <code>RandomNumberGenerator</code> is a random number generator found in the <code>dqrng</code> R package <span class="citation">(<a href="#ref-dqrng">Stubner 2023</a>)</span>, renamed in an attempt make it look less intimidating to the casual C++ user. For the remainder of the section, we focus on describing the <code>Parameters</code> class (<code>Data</code> has the same functionality).</p>
<p>The <code>Parameters</code> class can be thought of as being similar to an R list or python dictionary, where each element is indexed by a <code>std::string</code> key, and each element has the type <code>arma::mat</code> (a matrix, from the armadillo library). Full documentation for this class can be found in the <a href="html/parameters_8h.html"><code>Parameters</code> file</a> in the <a href="html/index.html">ilike cpp documentation</a>. The file itself can be found in the package <code>inst/include</code> directory. Here we describe the most commonly used functions.</p>
<div id="constructors" class="section level4 hasAnchor" number="2.3.2.1">
<h4><span class="header-section-number">2.3.2.1</span> Constructors<a href="C.html#constructors" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb8"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb8-1"><a href="C.html#cb8-1" tabindex="-1"></a>Parameters<span class="op">();</span></span></code></pre></div>
<p>This constructs an empty Parameters object.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb9-1"><a href="C.html#cb9-1" tabindex="-1"></a>Parameters<span class="op">(</span><span class="at">const</span> <span class="bu">std::</span>string<span class="op"> &amp;</span>variable_in<span class="op">,</span></span>
<span id="cb9-2"><a href="C.html#cb9-2" tabindex="-1"></a>           <span class="dt">double</span> value_in<span class="op">);</span></span></code></pre></div>
<p>This constructs a Parameters object with the given <code>double</code> stored in a <span class="math inline">\(1\times 1\)</span> dimensional <code>arma::mat</code> matrix, indexed by the key given by the <code>std::string</code>.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb10-1"><a href="C.html#cb10-1" tabindex="-1"></a>Parameters<span class="op">(</span><span class="at">const</span> <span class="bu">std::</span>string<span class="op"> &amp;</span>variable_in<span class="op">,</span></span>
<span id="cb10-2"><a href="C.html#cb10-2" tabindex="-1"></a>           <span class="at">const</span> arma<span class="op">::</span>mat <span class="op">&amp;</span>value_in<span class="op">);</span></span></code></pre></div>
<p>This constructs a Parameters object with the given <code>arma::mat</code> stored in the Parameters object with index by the key given by the <code>std::string</code>. An <code>arma::colvec</code> can also be supplied as an argument to this function, with the armadillo library dealing with the conversion between the types.</p>
</div>
<div id="element-access" class="section level4 hasAnchor" number="2.3.2.2">
<h4><span class="header-section-number">2.3.2.2</span> Element access<a href="C.html#element-access" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb11"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb11-1"><a href="C.html#cb11-1" tabindex="-1"></a>arma<span class="op">::</span>mat<span class="op">&amp;</span> <span class="kw">operator</span><span class="op">[](</span><span class="at">const</span> <span class="bu">std::</span>string<span class="op"> &amp;</span>variable<span class="op">);</span></span>
<span id="cb11-2"><a href="C.html#cb11-2" tabindex="-1"></a>arma<span class="op">::</span>mat <span class="kw">operator</span><span class="op">[](</span><span class="at">const</span> <span class="bu">std::</span>string<span class="op"> &amp;</span>variable<span class="op">)</span> <span class="at">const</span><span class="op">;</span></span></code></pre></div>
<p>These functions allow: (a) the assignment to an existing <code>Parameters</code> object of a new <code>arma::mat</code>, indexed by the key given by the <code>std::string</code>; and (b) accessing in a <code>Parameters</code>object the <code>arma::mat</code>, indexed by the key given by the <code>std::string</code>.</p>
<p>For example, to store a column vector with the key <code>"x"</code>:</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb12-1"><a href="C.html#cb12-1" tabindex="-1"></a>arma<span class="op">::</span>colvec a_vector<span class="op">(</span><span class="dv">2</span><span class="op">);</span></span>
<span id="cb12-2"><a href="C.html#cb12-2" tabindex="-1"></a>a_vector<span class="op">[</span><span class="dv">0</span><span class="op">]</span> <span class="op">=</span> <span class="fl">1.0</span><span class="op">;</span></span>
<span id="cb12-3"><a href="C.html#cb12-3" tabindex="-1"></a>a_vector<span class="op">[</span><span class="dv">1</span><span class="op">]</span> <span class="op">=</span> <span class="fl">4.0</span><span class="op">;</span></span>
<span id="cb12-4"><a href="C.html#cb12-4" tabindex="-1"></a>Parameters parameters<span class="op">;</span></span>
<span id="cb12-5"><a href="C.html#cb12-5" tabindex="-1"></a>parameters<span class="op">[</span><span class="st">&quot;x&quot;</span><span class="op">]</span> <span class="op">=</span> a_vector<span class="op">;</span></span></code></pre></div>
<p>Then, to subsequently access the vector in the <code>parameters</code> object:</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb13-1"><a href="C.html#cb13-1" tabindex="-1"></a>arma<span class="op">::</span>colvec x <span class="op">=</span> parameters<span class="op">[</span><span class="st">&quot;x&quot;</span><span class="op">];</span></span></code></pre></div>
</div>
<div id="copying" class="section level4 hasAnchor" number="2.3.2.3">
<h4><span class="header-section-number">2.3.2.3</span> Copying<a href="C.html#copying" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb14"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb14-1"><a href="C.html#cb14-1" tabindex="-1"></a>Parameters<span class="op">(</span><span class="at">const</span> Parameters <span class="op">&amp;</span>another<span class="op">);</span></span>
<span id="cb14-2"><a href="C.html#cb14-2" tabindex="-1"></a>Parameters<span class="op">&amp;</span> <span class="kw">operator</span><span class="op">=(</span><span class="at">const</span> Parameters <span class="op">&amp;</span>another<span class="op">);</span></span></code></pre></div>
<p>These functions allow a parameters object to be copied, using a copy constructor and an <code>operator=</code> respectively. Examples of each follow:</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb15-1"><a href="C.html#cb15-1" tabindex="-1"></a><span class="co">// using a copy constructor to copy the object &quot;parameters&quot;, which was defined in the previous code chunk</span></span>
<span id="cb15-2"><a href="C.html#cb15-2" tabindex="-1"></a>Parameters copied_parameters<span class="op">(</span>parameters<span class="op">);</span></span>
<span id="cb15-3"><a href="C.html#cb15-3" tabindex="-1"></a></span>
<span id="cb15-4"><a href="C.html#cb15-4" tabindex="-1"></a><span class="co">// using operator= to copy &quot;parameters&quot;</span></span>
<span id="cb15-5"><a href="C.html#cb15-5" tabindex="-1"></a>Parameters another_copied_parameters <span class="op">=</span> parameters<span class="op">;</span></span></code></pre></div>
</div>
<div id="combining" class="section level4 hasAnchor" number="2.3.2.4">
<h4><span class="header-section-number">2.3.2.4</span> Combining<a href="C.html#combining" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb16"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb16-1"><a href="C.html#cb16-1" tabindex="-1"></a>Parameters merge<span class="op">(</span><span class="at">const</span> Parameters <span class="op">&amp;</span>another<span class="op">)</span> <span class="at">const</span><span class="op">;</span></span></code></pre></div>
<p>This function combines two <code>Parameters</code> objects into one. Each element in the object taken as an argument is inserted only if its key is not equivalent to the key of any other element already in the container. For example:</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb17-1"><a href="C.html#cb17-1" tabindex="-1"></a><span class="co">// make more vectors to store in a Parameters object</span></span>
<span id="cb17-2"><a href="C.html#cb17-2" tabindex="-1"></a>arma<span class="op">::</span>colvec b_vector<span class="op">(</span><span class="dv">1</span><span class="op">);</span></span>
<span id="cb17-3"><a href="C.html#cb17-3" tabindex="-1"></a>b_vector<span class="op">[</span><span class="dv">0</span><span class="op">]</span> <span class="op">=</span> <span class="fl">5.0</span><span class="op">;</span></span>
<span id="cb17-4"><a href="C.html#cb17-4" tabindex="-1"></a></span>
<span id="cb17-5"><a href="C.html#cb17-5" tabindex="-1"></a>arma<span class="op">::</span>colvec c_vector<span class="op">(</span><span class="dv">1</span><span class="op">);</span></span>
<span id="cb17-6"><a href="C.html#cb17-6" tabindex="-1"></a>c_vector<span class="op">[</span><span class="dv">0</span><span class="op">]</span> <span class="op">=</span> <span class="fl">12.0</span><span class="op">;</span></span>
<span id="cb17-7"><a href="C.html#cb17-7" tabindex="-1"></a></span>
<span id="cb17-8"><a href="C.html#cb17-8" tabindex="-1"></a><span class="co">// make another Parameters object that we will merge with the one we made above.</span></span>
<span id="cb17-9"><a href="C.html#cb17-9" tabindex="-1"></a>Parameters more_parameters<span class="op">;</span></span>
<span id="cb17-10"><a href="C.html#cb17-10" tabindex="-1"></a>more_parameters<span class="op">[</span><span class="st">&quot;x&quot;</span><span class="op">]</span> <span class="op">=</span> b_vector<span class="op">;</span></span>
<span id="cb17-11"><a href="C.html#cb17-11" tabindex="-1"></a>more_parameters<span class="op">[</span><span class="st">&quot;y&quot;</span><span class="op">]</span> <span class="op">=</span> c_vector<span class="op">;</span></span>
<span id="cb17-12"><a href="C.html#cb17-12" tabindex="-1"></a></span>
<span id="cb17-13"><a href="C.html#cb17-13" tabindex="-1"></a><span class="co">// perform the merge</span></span>
<span id="cb17-14"><a href="C.html#cb17-14" tabindex="-1"></a><span class="co">// both parameters and more_parameters have the key &quot;x&quot;,</span></span>
<span id="cb17-15"><a href="C.html#cb17-15" tabindex="-1"></a><span class="co">// so the &quot;x&quot; element from parameters,</span></span>
<span id="cb17-16"><a href="C.html#cb17-16" tabindex="-1"></a><span class="co">// and the &quot;y&quot; element from more_parameters are found in the result</span></span>
<span id="cb17-17"><a href="C.html#cb17-17" tabindex="-1"></a>Parameters yet_more_parameters <span class="op">=</span> parameters<span class="op">.</span>merge<span class="op">(</span>more_parameters<span class="op">);</span></span></code></pre></div>
</div>
<div id="printing" class="section level4 hasAnchor" number="2.3.2.5">
<h4><span class="header-section-number">2.3.2.5</span> Printing<a href="C.html#printing" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb18"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb18-1"><a href="C.html#cb18-1" tabindex="-1"></a><span class="bu">std::</span>ostream<span class="op">&amp;</span> <span class="kw">operator</span><span class="op">&lt;&lt;(</span><span class="bu">std::</span>ostream<span class="op">&amp;</span> os<span class="op">,</span> <span class="at">const</span> Parameters <span class="op">&amp;</span>p<span class="op">);</span></span></code></pre></div>
<p>This function prints a <code>Parameters</code> object to an output stream. For example, to print to console:</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb19-1"><a href="C.html#cb19-1" tabindex="-1"></a><span class="bu">std::</span>cout<span class="op"> &lt;&lt;</span> parameters<span class="op">;</span></span></code></pre></div>
</div>
</div>
<div id="ilike-cpp-functions" class="section level3 hasAnchor" number="2.3.3">
<h3><span class="header-section-number">2.3.3</span> ilike C++ functions<a href="C.html#ilike-cpp-functions" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Functions from any C++ library may be used to simplify the writing of an ilike file, provided the functions being used are found in header files only. The <code>boost</code> library is particularly easy to use in this setting, since most of the <code>boost</code> header files are available directly through ilike’s depdendece on the <code>BH</code> R package <span class="citation">(<a href="#ref-BH">Eddelbuettel, Emerson, and Kane 2024</a>)</span>.</p>
<p>ilike itself contains a number of C++ functions that might be useful. Most of these provide methods for simulating points from, or evaluating the density of. various commonly used distributions. The arguments taken bv these functions are chosen to be, where possible, roughly consistent with the corresponding functions in R. All functions involving the simulation of random points require a <code>RandomNumberGenerator</code> as their first argument (most provide an interface to the corresponding functions in <code>boost</code>). The use of a <code>RandomNumberGenerator</code> distinguishes these functions from <a href="https://teuder.github.io/rcpp4everyone_en/220_dpqr_functions.html">those found in Rcpp</a>. Use of the ilike functions is recommended in ilike files, to ensure correct handling of the random number streams in the ilike inference engine.</p>
<p>Casual C++ users may not be familiar with the type <code>size_t</code>: this can be thought of as a non-negative integer.</p>
<div id="hz-test" class="section level4 hasAnchor" number="2.3.3.1">
<h4><span class="header-section-number">2.3.3.1</span> hz test<a href="C.html#hz-test" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<hr />
<div class="sourceCode" id="cb20"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb20-1"><a href="C.html#cb20-1" tabindex="-1"></a><span class="dt">double</span> hz<span class="op">(</span><span class="at">const</span> arma<span class="op">::</span>mat <span class="op">&amp;</span>data_in<span class="op">)</span></span></code></pre></div>
<p>Implements Henze-Zirkler’s test for multivariate linearity: a translation into C++ of the code found in the <a href="https://CRAN.R-project.org/package=MVN">MVN R package</a> <span class="citation">(<a href="#ref-MVN">Korkmaz, Goksuluk, and Zararsiz 2014</a>)</span>.</p>
</div>
<div id="log-sum-exp" class="section level4 hasAnchor" number="2.3.3.2">
<h4><span class="header-section-number">2.3.3.2</span> log-sum-exp<a href="C.html#log-sum-exp" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<hr />
<div class="sourceCode" id="cb21"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb21-1"><a href="C.html#cb21-1" tabindex="-1"></a><span class="dt">double</span> log_sum_exp<span class="op">(</span><span class="at">const</span> arma<span class="op">::</span>colvec <span class="op">&amp;</span>log_weights<span class="op">)</span></span></code></pre></div>
<p>This function implements the <a href="https://en.wikipedia.org/wiki/LogSumExp">LogSumExp trick</a> on the inputted vector.</p>
</div>
<div id="weighted-mean-and-covariance" class="section level4 hasAnchor" number="2.3.3.3">
<h4><span class="header-section-number">2.3.3.3</span> Weighted mean and covariance<a href="C.html#weighted-mean-and-covariance" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<hr />
<div class="sourceCode" id="cb22"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb22-1"><a href="C.html#cb22-1" tabindex="-1"></a>arma<span class="op">::</span>rowvec mean_wt<span class="op">(</span><span class="at">const</span> arma<span class="op">::</span>mat <span class="op">&amp;</span>x<span class="op">,</span></span>
<span id="cb22-2"><a href="C.html#cb22-2" tabindex="-1"></a>                     <span class="at">const</span> arma<span class="op">::</span>colvec <span class="op">&amp;</span>wt<span class="op">);</span></span>
<span id="cb22-3"><a href="C.html#cb22-3" tabindex="-1"></a>arma<span class="op">::</span>mat cov_wt<span class="op">(</span><span class="at">const</span> arma<span class="op">::</span>mat <span class="op">&amp;</span>x<span class="op">,</span></span>
<span id="cb22-4"><a href="C.html#cb22-4" tabindex="-1"></a>                 <span class="at">const</span> arma<span class="op">::</span>colvec <span class="op">&amp;</span>wt<span class="op">);</span></span></code></pre></div>
<p>The functions compute the weighted (using weight <code>wt</code>) mean and covariance of the data found in the rows of <code>x</code>. The vector <code>wt</code> needs to be normalised.</p>
</div>
<div id="discrete-distribution" class="section level4 hasAnchor" number="2.3.3.4">
<h4><span class="header-section-number">2.3.3.4</span> Discrete distribution<a href="C.html#discrete-distribution" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<hr />
<div class="sourceCode" id="cb23"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb23-1"><a href="C.html#cb23-1" tabindex="-1"></a><span class="dt">size_t</span> rdis<span class="op">(</span>RandomNumberGenerator <span class="op">&amp;</span>rng<span class="op">,</span></span>
<span id="cb23-2"><a href="C.html#cb23-2" tabindex="-1"></a>            <span class="at">const</span> arma<span class="op">::</span>colvec <span class="op">&amp;</span>probabilities<span class="op">);</span></span></code></pre></div>
<p>Generates a random number from the discrete distribution taking values <span class="math inline">\([0,n)\)</span>, with probabilities given by the vector <code>probabilities</code>, and <code>n</code> being taken to be the length of this vector. The vector <code>probabilities</code> need not be normalised.</p>
<hr />
<div class="sourceCode" id="cb24"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb24-1"><a href="C.html#cb24-1" tabindex="-1"></a>arma<span class="op">::</span>uvec multiple_rdis<span class="op">(</span>RandomNumberGenerator <span class="op">&amp;</span>rng<span class="op">,</span></span>
<span id="cb24-2"><a href="C.html#cb24-2" tabindex="-1"></a>                         <span class="dt">size_t</span> n<span class="op">,</span></span>
<span id="cb24-3"><a href="C.html#cb24-3" tabindex="-1"></a>                         <span class="at">const</span> arma<span class="op">::</span>colvec <span class="op">&amp;</span>probabilities<span class="op">);</span></span></code></pre></div>
<p>Generates <code>n</code> random numbers from the discrete distribution taking values <span class="math inline">\([0,n)\)</span>, with probabilities given by the vector <code>probabilities</code>, and <code>n</code> being taken to be the length of this vector. The vector <code>probabilities</code> need not be normalised.</p>
</div>
<div id="exponential-distribution" class="section level4 hasAnchor" number="2.3.3.5">
<h4><span class="header-section-number">2.3.3.5</span> Exponential distribution<a href="C.html#exponential-distribution" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<hr />
<div class="sourceCode" id="cb25"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb25-1"><a href="C.html#cb25-1" tabindex="-1"></a><span class="dt">double</span> rexp<span class="op">(</span>RandomNumberGenerator <span class="op">&amp;</span>rng<span class="op">,</span></span>
<span id="cb25-2"><a href="C.html#cb25-2" tabindex="-1"></a>            <span class="dt">double</span> rate<span class="op">);</span></span></code></pre></div>
<p>Generates a random number from the exponential distribution with rate <code>rate</code>.</p>
<hr />
<div class="sourceCode" id="cb26"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb26-1"><a href="C.html#cb26-1" tabindex="-1"></a>arma<span class="op">::</span>colvec rexp<span class="op">(</span>RandomNumberGenerator <span class="op">&amp;</span>rng<span class="op">,</span></span>
<span id="cb26-2"><a href="C.html#cb26-2" tabindex="-1"></a>                  <span class="dt">size_t</span> n<span class="op">,</span></span>
<span id="cb26-3"><a href="C.html#cb26-3" tabindex="-1"></a>                  <span class="dt">double</span> rate<span class="op">);</span></span></code></pre></div>
<p>Generates <code>n</code> random numbers from the exponential distribution with rate <code>rate</code>.</p>
<hr />
<div class="sourceCode" id="cb27"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb27-1"><a href="C.html#cb27-1" tabindex="-1"></a><span class="dt">double</span> dexp<span class="op">(</span><span class="dt">double</span> x<span class="op">,</span></span>
<span id="cb27-2"><a href="C.html#cb27-2" tabindex="-1"></a>            <span class="dt">double</span> rate<span class="op">);</span></span></code></pre></div>
<p>Evaluates the log of the exponential density with rate <code>rate</code> at the point <code>x</code>.</p>
<hr />
<div class="sourceCode" id="cb28"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb28-1"><a href="C.html#cb28-1" tabindex="-1"></a><span class="dt">double</span> rtranslatedexp<span class="op">(</span>RandomNumberGenerator <span class="op">&amp;</span>rng<span class="op">,</span></span>
<span id="cb28-2"><a href="C.html#cb28-2" tabindex="-1"></a>                      <span class="dt">double</span> rate<span class="op">,</span></span>
<span id="cb28-3"><a href="C.html#cb28-3" tabindex="-1"></a>                      <span class="dt">double</span> min<span class="op">);</span></span></code></pre></div>
<p>Generates a random number from the translated (by <code>min</code>) exponential distribution with rate <code>rate</code>.</p>
<hr />
<div class="sourceCode" id="cb29"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb29-1"><a href="C.html#cb29-1" tabindex="-1"></a>arma<span class="op">::</span>colvec rtranslatedexp<span class="op">(</span>RandomNumberGenerator <span class="op">&amp;</span>rng<span class="op">,</span></span>
<span id="cb29-2"><a href="C.html#cb29-2" tabindex="-1"></a>                            <span class="dt">size_t</span> n<span class="op">,</span></span>
<span id="cb29-3"><a href="C.html#cb29-3" tabindex="-1"></a>                            <span class="dt">double</span> rate<span class="op">,</span></span>
<span id="cb29-4"><a href="C.html#cb29-4" tabindex="-1"></a>                            <span class="dt">double</span> min<span class="op">);</span></span></code></pre></div>
<p>Generates <code>n</code> random numbers from the translated (by <code>min</code>) exponential distribution with rate <code>rate</code>.</p>
<hr />
<div class="sourceCode" id="cb30"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb30-1"><a href="C.html#cb30-1" tabindex="-1"></a><span class="dt">double</span> dtranslatedexp<span class="op">(</span><span class="dt">double</span> x<span class="op">,</span></span>
<span id="cb30-2"><a href="C.html#cb30-2" tabindex="-1"></a>                      <span class="dt">double</span> rate<span class="op">,</span></span>
<span id="cb30-3"><a href="C.html#cb30-3" tabindex="-1"></a>                      <span class="dt">double</span> min<span class="op">);</span></span></code></pre></div>
<p>Evaluates the log of the translated exponential (by <code>min</code>) density with rate <code>rate</code> at the point <code>x</code>.</p>
</div>
<div id="gamma-distribution" class="section level4 hasAnchor" number="2.3.3.6">
<h4><span class="header-section-number">2.3.3.6</span> Gamma distribution<a href="C.html#gamma-distribution" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<hr />
<div class="sourceCode" id="cb31"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb31-1"><a href="C.html#cb31-1" tabindex="-1"></a><span class="dt">double</span> rgamma<span class="op">(</span>RandomNumberGenerator <span class="op">&amp;</span>rng<span class="op">,</span></span>
<span id="cb31-2"><a href="C.html#cb31-2" tabindex="-1"></a>              <span class="dt">double</span> shape<span class="op">,</span></span>
<span id="cb31-3"><a href="C.html#cb31-3" tabindex="-1"></a>              <span class="dt">double</span> rate<span class="op">);</span></span></code></pre></div>
<p>Generates a random number from the gamma distribution with shape <code>shape</code> and rate <code>rate</code>.</p>
<hr />
<div class="sourceCode" id="cb32"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb32-1"><a href="C.html#cb32-1" tabindex="-1"></a>arma<span class="op">::</span>colvec rgamma<span class="op">(</span>RandomNumberGenerator <span class="op">&amp;</span>rng<span class="op">,</span></span>
<span id="cb32-2"><a href="C.html#cb32-2" tabindex="-1"></a>                    <span class="dt">size_t</span> n<span class="op">,</span></span>
<span id="cb32-3"><a href="C.html#cb32-3" tabindex="-1"></a>                    <span class="dt">double</span> shape<span class="op">,</span></span>
<span id="cb32-4"><a href="C.html#cb32-4" tabindex="-1"></a>                    <span class="dt">double</span> rate<span class="op">);</span></span>
<span id="cb32-5"><a href="C.html#cb32-5" tabindex="-1"></a><span class="op">---</span></span></code></pre></div>
<p>Generates <code>n</code> random numbers from the gamma distribution with shape <code>shape</code> and rate <code>rate</code>.</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb33-1"><a href="C.html#cb33-1" tabindex="-1"></a><span class="dt">double</span> dgamma<span class="op">(</span><span class="dt">double</span> x<span class="op">,</span></span>
<span id="cb33-2"><a href="C.html#cb33-2" tabindex="-1"></a>              <span class="dt">double</span> shape<span class="op">,</span></span>
<span id="cb33-3"><a href="C.html#cb33-3" tabindex="-1"></a>              <span class="dt">double</span> rate<span class="op">);</span></span></code></pre></div>
<p>Evaluates the log of the gamma density with shape <code>shape</code> and rate <code>rate</code> at the point <code>x</code>.</p>
</div>
<div id="log-normal-and-multivariate-log-normal-distribution" class="section level4 hasAnchor" number="2.3.3.7">
<h4><span class="header-section-number">2.3.3.7</span> Log-normal and multivariate log-normal distribution<a href="C.html#log-normal-and-multivariate-log-normal-distribution" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<hr />
<div class="sourceCode" id="cb34"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb34-1"><a href="C.html#cb34-1" tabindex="-1"></a><span class="dt">double</span> rlnorm<span class="op">(</span>RandomNumberGenerator <span class="op">&amp;</span>rng<span class="op">,</span></span>
<span id="cb34-2"><a href="C.html#cb34-2" tabindex="-1"></a>              <span class="dt">double</span> meanlog<span class="op">,</span></span>
<span id="cb34-3"><a href="C.html#cb34-3" tabindex="-1"></a>              <span class="dt">double</span> sdlog<span class="op">)</span></span>
<span id="cb34-4"><a href="C.html#cb34-4" tabindex="-1"></a><span class="op">{</span></span>
<span id="cb34-5"><a href="C.html#cb34-5" tabindex="-1"></a>  <span class="ex">boost::</span>random<span class="ex">::</span>lognormal_distribution<span class="op">&lt;</span><span class="dt">double</span><span class="op">&gt;</span> my_gamma<span class="op">(</span>meanlog<span class="op">,</span> sdlog<span class="op">);</span></span>
<span id="cb34-6"><a href="C.html#cb34-6" tabindex="-1"></a>  <span class="cf">return</span> my_gamma<span class="op">(</span>rng<span class="op">);</span></span>
<span id="cb34-7"><a href="C.html#cb34-7" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<p>Generates a random number from the log-normal distribution with mean of the log of the variable <code>meanlog</code> and standard deviation of the log of the variable <code>sdlog</code>.</p>
<hr />
<div class="sourceCode" id="cb35"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb35-1"><a href="C.html#cb35-1" tabindex="-1"></a>arma<span class="op">::</span>colvec rlnorm<span class="op">(</span>RandomNumberGenerator <span class="op">&amp;</span>rng<span class="op">,</span></span>
<span id="cb35-2"><a href="C.html#cb35-2" tabindex="-1"></a>                    <span class="dt">size_t</span> n<span class="op">,</span></span>
<span id="cb35-3"><a href="C.html#cb35-3" tabindex="-1"></a>                    <span class="dt">double</span> meanlog<span class="op">,</span></span>
<span id="cb35-4"><a href="C.html#cb35-4" tabindex="-1"></a>                    <span class="dt">double</span> sdlog<span class="op">);</span></span></code></pre></div>
<p>Generates <code>n</code> random numbers from the log-normal distribution with mean of the log of the variable <code>meanlog</code> and standard deviation of the log of the variable <code>sdlog</code>.</p>
<hr />
<div class="sourceCode" id="cb36"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb36-1"><a href="C.html#cb36-1" tabindex="-1"></a><span class="dt">double</span> dlnorm<span class="op">(</span><span class="dt">double</span> x<span class="op">,</span></span>
<span id="cb36-2"><a href="C.html#cb36-2" tabindex="-1"></a>              <span class="dt">double</span> meanlog<span class="op">,</span></span>
<span id="cb36-3"><a href="C.html#cb36-3" tabindex="-1"></a>              <span class="dt">double</span> sdlog<span class="op">)</span></span>
<span id="cb36-4"><a href="C.html#cb36-4" tabindex="-1"></a><span class="op">{</span></span>
<span id="cb36-5"><a href="C.html#cb36-5" tabindex="-1"></a>  <span class="cf">if</span> <span class="op">(</span>sdlog<span class="op">&lt;</span><span class="dv">0</span><span class="op">)</span></span>
<span id="cb36-6"><a href="C.html#cb36-6" tabindex="-1"></a>  <span class="op">{</span></span>
<span id="cb36-7"><a href="C.html#cb36-7" tabindex="-1"></a>    <span class="cf">return</span> NAN<span class="op">;</span></span>
<span id="cb36-8"><a href="C.html#cb36-8" tabindex="-1"></a>  <span class="op">}</span></span>
<span id="cb36-9"><a href="C.html#cb36-9" tabindex="-1"></a>  <span class="cf">if</span> <span class="op">(</span>sdlog<span class="op">==</span><span class="dv">0</span><span class="op">)</span></span>
<span id="cb36-10"><a href="C.html#cb36-10" tabindex="-1"></a>  <span class="op">{</span></span>
<span id="cb36-11"><a href="C.html#cb36-11" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>x<span class="op">==</span>meanlog<span class="op">)</span></span>
<span id="cb36-12"><a href="C.html#cb36-12" tabindex="-1"></a>      <span class="cf">return</span> arma<span class="op">::</span>datum<span class="op">::</span>inf<span class="op">;</span></span>
<span id="cb36-13"><a href="C.html#cb36-13" tabindex="-1"></a>    <span class="cf">else</span></span>
<span id="cb36-14"><a href="C.html#cb36-14" tabindex="-1"></a>      <span class="cf">return</span> <span class="op">-</span>arma<span class="op">::</span>datum<span class="op">::</span>inf<span class="op">;</span></span>
<span id="cb36-15"><a href="C.html#cb36-15" tabindex="-1"></a>  <span class="op">}</span></span>
<span id="cb36-16"><a href="C.html#cb36-16" tabindex="-1"></a>  <span class="cf">return</span> <span class="op">-</span> log<span class="op">(</span>x<span class="op">)</span> <span class="op">-</span> log<span class="op">(</span>sdlog<span class="op">)</span> <span class="op">-</span> <span class="fl">0.5</span><span class="op">*</span>log<span class="op">(</span><span class="fl">2.0</span><span class="op">*</span>M_PI<span class="op">)</span> <span class="op">-</span> <span class="fl">0.5</span><span class="op">*</span>pow<span class="op">((</span>log<span class="op">(</span>x<span class="op">)-</span>meanlog<span class="op">)/</span>sdlog<span class="op">,</span><span class="fl">2.0</span><span class="op">);</span></span>
<span id="cb36-17"><a href="C.html#cb36-17" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<p>Evaluates the log of the log-normal density with mean of the log of the variable <code>meanlog</code> and standard deviation of the log of the variable <code>sdlog</code> at the point <code>x</code>.</p>
<hr />
<div class="sourceCode" id="cb37"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb37-1"><a href="C.html#cb37-1" tabindex="-1"></a>arma<span class="op">::</span>colvec rmvlnorm<span class="op">(</span>RandomNumberGenerator <span class="op">&amp;</span>rng<span class="op">,</span></span>
<span id="cb37-2"><a href="C.html#cb37-2" tabindex="-1"></a>                             <span class="at">const</span> arma<span class="op">::</span>colvec <span class="op">&amp;</span>mulog<span class="op">,</span></span>
<span id="cb37-3"><a href="C.html#cb37-3" tabindex="-1"></a>                             <span class="at">const</span> arma<span class="op">::</span>mat <span class="op">&amp;</span>Sigmalog<span class="op">);</span></span></code></pre></div>
<p>Generates a random number from the multivariate log-normal distribution with mean of the log of the variable <code>meanlog</code> and covariance of the log of the variable <code>Sigmalog</code>.</p>
<hr />
<div class="sourceCode" id="cb38"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb38-1"><a href="C.html#cb38-1" tabindex="-1"></a><span class="dt">double</span> dmvlnorm<span class="op">(</span><span class="at">const</span> arma<span class="op">::</span>colvec <span class="op">&amp;</span>x<span class="op">,</span></span>
<span id="cb38-2"><a href="C.html#cb38-2" tabindex="-1"></a>                       <span class="at">const</span> arma<span class="op">::</span>colvec <span class="op">&amp;</span>mulog<span class="op">,</span></span>
<span id="cb38-3"><a href="C.html#cb38-3" tabindex="-1"></a>                       <span class="at">const</span> arma<span class="op">::</span>mat <span class="op">&amp;</span>Sigmalog<span class="op">)</span></span>
<span id="cb38-4"><a href="C.html#cb38-4" tabindex="-1"></a><span class="dt">double</span> dmvlnorm_using_precomp<span class="op">(</span><span class="at">const</span> arma<span class="op">::</span>colvec <span class="op">&amp;</span>x<span class="op">,</span></span>
<span id="cb38-5"><a href="C.html#cb38-5" tabindex="-1"></a>                                     <span class="at">const</span> arma<span class="op">::</span>colvec <span class="op">&amp;</span>mulog<span class="op">,</span></span>
<span id="cb38-6"><a href="C.html#cb38-6" tabindex="-1"></a>                                     <span class="at">const</span> arma<span class="op">::</span>mat <span class="op">&amp;</span>inv_Sigmalog<span class="op">,</span></span>
<span id="cb38-7"><a href="C.html#cb38-7" tabindex="-1"></a>                                     <span class="dt">double</span> log_det<span class="op">)</span></span></code></pre></div>
<p>Evaluates the log of the multivariate log-normal density with mean of the log of the variable <code>meanlog</code> and covariance of the log of the variable <code>Sigmalog</code> at the point <code>x</code>. The latter function does not require the covariance as an argument: instead it takes the inverse of the covariance <code>inv_Sigma</code> and the log of the determinant of the covariance (<code>log_det</code>). This is designed for cases where the density needs to be evaluated at a number of points using the same covariance; using this function avoids performing the most expensive parts of the computation more than once.</p>
</div>
<div id="normalgaussian-and-multivariate-normalgaussian-distribution" class="section level4 hasAnchor" number="2.3.3.8">
<h4><span class="header-section-number">2.3.3.8</span> Normal/Gaussian and multivariate normal/Gaussian distribution<a href="C.html#normalgaussian-and-multivariate-normalgaussian-distribution" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<hr />
<div class="sourceCode" id="cb39"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb39-1"><a href="C.html#cb39-1" tabindex="-1"></a><span class="dt">double</span> rnorm<span class="op">(</span>RandomNumberGenerator <span class="op">&amp;</span>rng<span class="op">);</span></span></code></pre></div>
<p>Generates a random number from the standard normal distribution.</p>
<hr />
<div class="sourceCode" id="cb40"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb40-1"><a href="C.html#cb40-1" tabindex="-1"></a>arma<span class="op">::</span>mat rnorm<span class="op">(</span>RandomNumberGenerator <span class="op">&amp;</span>rng<span class="op">,</span></span>
<span id="cb40-2"><a href="C.html#cb40-2" tabindex="-1"></a>                <span class="dt">size_t</span> n<span class="op">);</span></span></code></pre></div>
<p>Generates <code>n</code> random numbers from the standard normal distribution.</p>
<hr />
<div class="sourceCode" id="cb41"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb41-1"><a href="C.html#cb41-1" tabindex="-1"></a>arma<span class="op">::</span>mat rnorm<span class="op">(</span>RandomNumberGenerator <span class="op">&amp;</span>rng<span class="op">,</span></span>
<span id="cb41-2"><a href="C.html#cb41-2" tabindex="-1"></a>                <span class="bu">std::</span>pair<span class="op">&lt;</span><span class="dt">size_t</span><span class="op">,</span><span class="dt">size_t</span><span class="op">&gt;</span> dimensions<span class="op">);</span></span></code></pre></div>
<p>Generates a matrix (of dimension given by <code>dimensions</code>) of random numbers from the standard normal distribution.</p>
<hr />
<div class="sourceCode" id="cb42"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb42-1"><a href="C.html#cb42-1" tabindex="-1"></a><span class="dt">double</span> dnorm<span class="op">(</span><span class="dt">double</span> x<span class="op">);</span></span></code></pre></div>
<p>Evaluates the log of the standard normal density at the point <code>x</code>.</p>
<hr />
<div class="sourceCode" id="cb43"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb43-1"><a href="C.html#cb43-1" tabindex="-1"></a><span class="dt">double</span> rnorm<span class="op">(</span>RandomNumberGenerator <span class="op">&amp;</span>rng<span class="op">,</span></span>
<span id="cb43-2"><a href="C.html#cb43-2" tabindex="-1"></a>             <span class="dt">double</span> mean<span class="op">,</span></span>
<span id="cb43-3"><a href="C.html#cb43-3" tabindex="-1"></a>             <span class="dt">double</span> sd<span class="op">);</span></span></code></pre></div>
<p>Generates a random number from the normal distribution with mean <code>mean</code> and standard deviation <code>sd</code>.</p>
<hr />
<div class="sourceCode" id="cb44"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb44-1"><a href="C.html#cb44-1" tabindex="-1"></a>arma<span class="op">::</span>mat rnorm<span class="op">(</span>RandomNumberGenerator <span class="op">&amp;</span>rng<span class="op">,</span></span>
<span id="cb44-2"><a href="C.html#cb44-2" tabindex="-1"></a>                <span class="dt">size_t</span> n<span class="op">,</span></span>
<span id="cb44-3"><a href="C.html#cb44-3" tabindex="-1"></a>                <span class="dt">double</span> mean<span class="op">,</span></span>
<span id="cb44-4"><a href="C.html#cb44-4" tabindex="-1"></a>                <span class="dt">double</span> sd<span class="op">);</span></span></code></pre></div>
<p>Generates <code>n</code> random numbers from the normal distribution with mean <code>mean</code> and standard deviation <code>sd</code>.</p>
<hr />
<div class="sourceCode" id="cb45"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb45-1"><a href="C.html#cb45-1" tabindex="-1"></a>arma<span class="op">::</span>mat rnorm<span class="op">(</span>RandomNumberGenerator <span class="op">&amp;</span>rng<span class="op">,</span></span>
<span id="cb45-2"><a href="C.html#cb45-2" tabindex="-1"></a>                       <span class="bu">std::</span>pair<span class="op">&lt;</span><span class="dt">size_t</span><span class="op">,</span><span class="dt">size_t</span><span class="op">&gt;</span> dimensions<span class="op">,</span></span>
<span id="cb45-3"><a href="C.html#cb45-3" tabindex="-1"></a>                       <span class="dt">double</span> mean<span class="op">,</span></span>
<span id="cb45-4"><a href="C.html#cb45-4" tabindex="-1"></a>                       <span class="dt">double</span> sd<span class="op">);</span></span></code></pre></div>
<p>Generates a matrix (of dimension given by <code>dimensions</code>) of random numbers from the normal distribution with mean <code>mean</code> and standard deviation <code>sd</code>.</p>
<hr />
<div class="sourceCode" id="cb46"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb46-1"><a href="C.html#cb46-1" tabindex="-1"></a><span class="dt">double</span> dnorm<span class="op">(</span><span class="dt">double</span> x<span class="op">,</span></span>
<span id="cb46-2"><a href="C.html#cb46-2" tabindex="-1"></a>             <span class="dt">double</span> mean<span class="op">,</span></span>
<span id="cb46-3"><a href="C.html#cb46-3" tabindex="-1"></a>             <span class="dt">double</span> sd<span class="op">);</span></span></code></pre></div>
<p>Evaluates the log of the normal density with mean <code>mean</code> and standard deviation <code>sd</code> at the point <code>x</code>.</p>
<hr />
<div class="sourceCode" id="cb47"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb47-1"><a href="C.html#cb47-1" tabindex="-1"></a>arma<span class="op">::</span>colvec dnorm<span class="op">(</span><span class="at">const</span> arma<span class="op">::</span>colvec <span class="op">&amp;</span>x<span class="op">,</span></span>
<span id="cb47-2"><a href="C.html#cb47-2" tabindex="-1"></a>                   <span class="dt">double</span> mean<span class="op">,</span></span>
<span id="cb47-3"><a href="C.html#cb47-3" tabindex="-1"></a>                   <span class="dt">double</span> sd<span class="op">);</span></span>
<span id="cb47-4"><a href="C.html#cb47-4" tabindex="-1"></a>arma<span class="op">::</span>colvec dnorm<span class="op">(</span><span class="at">const</span> arma<span class="op">::</span>colvec <span class="op">&amp;</span>x<span class="op">,</span></span>
<span id="cb47-5"><a href="C.html#cb47-5" tabindex="-1"></a>                   <span class="at">const</span> arma<span class="op">::</span>colvec <span class="op">&amp;</span>mean<span class="op">,</span></span>
<span id="cb47-6"><a href="C.html#cb47-6" tabindex="-1"></a>                   <span class="dt">double</span> sd<span class="op">);</span></span>
<span id="cb47-7"><a href="C.html#cb47-7" tabindex="-1"></a>arma<span class="op">::</span>colvec dnorm<span class="op">(</span><span class="at">const</span> arma<span class="op">::</span>colvec <span class="op">&amp;</span>x<span class="op">,</span></span>
<span id="cb47-8"><a href="C.html#cb47-8" tabindex="-1"></a>                   <span class="dt">double</span> mean<span class="op">,</span></span>
<span id="cb47-9"><a href="C.html#cb47-9" tabindex="-1"></a>                   <span class="at">const</span> arma<span class="op">::</span>colvec <span class="op">&amp;</span>sd<span class="op">);</span></span>
<span id="cb47-10"><a href="C.html#cb47-10" tabindex="-1"></a>arma<span class="op">::</span>colvec dnorm<span class="op">(</span><span class="at">const</span> arma<span class="op">::</span>colvec <span class="op">&amp;</span>x<span class="op">,</span></span>
<span id="cb47-11"><a href="C.html#cb47-11" tabindex="-1"></a>                   <span class="at">const</span> arma<span class="op">::</span>colvec <span class="op">&amp;</span>mean<span class="op">,</span></span>
<span id="cb47-12"><a href="C.html#cb47-12" tabindex="-1"></a>                   <span class="at">const</span> arma<span class="op">::</span>colvec <span class="op">&amp;</span>sd<span class="op">);</span></span></code></pre></div>
<p>Evaluates the log of the normal density with mean <code>mean</code> and standard deviation <code>sd</code> at the vector of points <code>x</code>, returning a vector. If <code>mean</code> and/or <code>sd</code> are a <code>double</code>, the same mean/sd is used for all dimensions; if a vector the corresponding entry in that vector is used for each dimension.</p>
<hr />
<div class="sourceCode" id="cb48"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb48-1"><a href="C.html#cb48-1" tabindex="-1"></a>arma<span class="op">::</span>colvec rmvnorm<span class="op">(</span>RandomNumberGenerator <span class="op">&amp;</span>rng<span class="op">,</span></span>
<span id="cb48-2"><a href="C.html#cb48-2" tabindex="-1"></a>                     <span class="at">const</span> arma<span class="op">::</span>colvec <span class="op">&amp;</span>mu<span class="op">,</span></span>
<span id="cb48-3"><a href="C.html#cb48-3" tabindex="-1"></a>                     <span class="at">const</span> arma<span class="op">::</span>mat <span class="op">&amp;</span>Sigma<span class="op">);</span></span></code></pre></div>
<p>Generates a random vector from the multivariate normal distribution with mean <code>mu</code> and covariance <code>Sigma</code>.</p>
<hr />
<div class="sourceCode" id="cb49"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb49-1"><a href="C.html#cb49-1" tabindex="-1"></a>arma<span class="op">::</span>mat rmvnorm<span class="op">(</span>RandomNumberGenerator <span class="op">&amp;</span>rng<span class="op">,</span></span>
<span id="cb49-2"><a href="C.html#cb49-2" tabindex="-1"></a>                  <span class="dt">size_t</span> n<span class="op">,</span></span>
<span id="cb49-3"><a href="C.html#cb49-3" tabindex="-1"></a>                  <span class="at">const</span> arma<span class="op">::</span>colvec <span class="op">&amp;</span>mu<span class="op">,</span></span>
<span id="cb49-4"><a href="C.html#cb49-4" tabindex="-1"></a>                  <span class="at">const</span> arma<span class="op">::</span>mat <span class="op">&amp;</span>Sigma<span class="op">);</span></span></code></pre></div>
<p>Generates <code>n</code> random vectors from the multivariate normal distribution with mean <code>mu</code> and covariance <code>Sigma</code>, stored in a <span class="math inline">\(d\times n\)</span> matrix, where <span class="math inline">\(d\)</span> is the dimension of the multivariate Gaussian (determined by the size of the inputted mean and covariance).</p>
<hr />
<div class="sourceCode" id="cb50"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb50-1"><a href="C.html#cb50-1" tabindex="-1"></a><span class="dt">double</span> dmvnorm<span class="op">(</span><span class="at">const</span> arma<span class="op">::</span>colvec <span class="op">&amp;</span>x<span class="op">,</span></span>
<span id="cb50-2"><a href="C.html#cb50-2" tabindex="-1"></a>               <span class="at">const</span> arma<span class="op">::</span>colvec <span class="op">&amp;</span>mu<span class="op">,</span></span>
<span id="cb50-3"><a href="C.html#cb50-3" tabindex="-1"></a>               <span class="at">const</span> arma<span class="op">::</span>mat <span class="op">&amp;</span>Sigma<span class="op">);</span></span>
<span id="cb50-4"><a href="C.html#cb50-4" tabindex="-1"></a><span class="dt">double</span> dmvnorm_using_precomp<span class="op">(</span><span class="at">const</span> arma<span class="op">::</span>colvec <span class="op">&amp;</span>x<span class="op">,</span></span>
<span id="cb50-5"><a href="C.html#cb50-5" tabindex="-1"></a>                             <span class="at">const</span> arma<span class="op">::</span>colvec <span class="op">&amp;</span>mu<span class="op">,</span></span>
<span id="cb50-6"><a href="C.html#cb50-6" tabindex="-1"></a>                             <span class="at">const</span> arma<span class="op">::</span>mat <span class="op">&amp;</span>inv_Sigma<span class="op">,</span></span>
<span id="cb50-7"><a href="C.html#cb50-7" tabindex="-1"></a>                             <span class="dt">double</span> log_det<span class="op">);</span></span></code></pre></div>
<p>Evaluates the log of the multivariate normal density with mean <code>mu</code> and covariance <code>Sigma</code> at the vector <code>x</code>. The latter function does not require the covariance as an argument: instead it takes the inverse of the covariance <code>inv_Sigma</code> and the log of the determinant of the covariance (<code>log_det</code>). This is designed for cases where the density needs to be evaluated at a number of points using the same covariance; using this function avoids performing the most expensive parts of the computation more than once.</p>
</div>
<div id="truncated-normalgaussian-and-trucated-multivariate-normalgaussian-distributions" class="section level4 hasAnchor" number="2.3.3.9">
<h4><span class="header-section-number">2.3.3.9</span> Truncated normal/Gaussian and trucated multivariate normal/Gaussian distributions<a href="C.html#truncated-normalgaussian-and-trucated-multivariate-normalgaussian-distributions" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<hr />
<div class="sourceCode" id="cb51"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb51-1"><a href="C.html#cb51-1" tabindex="-1"></a><span class="dt">double</span> rtnorm<span class="op">(</span>RandomNumberGenerator <span class="op">&amp;</span>rng<span class="op">,</span></span>
<span id="cb51-2"><a href="C.html#cb51-2" tabindex="-1"></a>              <span class="dt">double</span> min<span class="op">,</span></span>
<span id="cb51-3"><a href="C.html#cb51-3" tabindex="-1"></a>              <span class="dt">double</span> max<span class="op">);</span></span></code></pre></div>
<p>Generates a random number from the standard truncated normal distribution, with bounds given by <code>min</code> and <code>max</code> (using the technique from <span class="citation">Robert (<a href="#ref-robert1995simulation">1995</a>)</span>).</p>
<hr />
<div class="sourceCode" id="cb52"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb52-1"><a href="C.html#cb52-1" tabindex="-1"></a>arma<span class="op">::</span>mat rtnorm<span class="op">(</span>RandomNumberGenerator <span class="op">&amp;</span>rng<span class="op">,</span></span>
<span id="cb52-2"><a href="C.html#cb52-2" tabindex="-1"></a>                 <span class="dt">size_t</span> n<span class="op">,</span></span>
<span id="cb52-3"><a href="C.html#cb52-3" tabindex="-1"></a>                 <span class="dt">double</span> min<span class="op">,</span></span>
<span id="cb52-4"><a href="C.html#cb52-4" tabindex="-1"></a>                 <span class="dt">double</span> max<span class="op">);</span></span></code></pre></div>
<p>Generates <code>n</code> random numbers from the standard truncated normal distribution, with bounds given by <code>min</code> and <code>max</code> (using the technique from <span class="citation">Robert (<a href="#ref-robert1995simulation">1995</a>)</span>).</p>
<hr />
<div class="sourceCode" id="cb53"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb53-1"><a href="C.html#cb53-1" tabindex="-1"></a>arma<span class="op">::</span>mat rtnorm<span class="op">(</span>RandomNumberGenerator <span class="op">&amp;</span>rng<span class="op">,</span></span>
<span id="cb53-2"><a href="C.html#cb53-2" tabindex="-1"></a>                 <span class="bu">std::</span>pair<span class="op">&lt;</span><span class="dt">size_t</span><span class="op">,</span><span class="dt">size_t</span><span class="op">&gt;</span> dimensions<span class="op">,</span></span>
<span id="cb53-3"><a href="C.html#cb53-3" tabindex="-1"></a>                 <span class="dt">double</span> min<span class="op">,</span></span>
<span id="cb53-4"><a href="C.html#cb53-4" tabindex="-1"></a>                 <span class="dt">double</span> max<span class="op">);</span></span></code></pre></div>
<p>Generates a matrix (of dimension given by <code>dimensions</code>) of random numbers from the standard truncated normal distribution, with bounds given by <code>min</code> and <code>max</code> (using the technique from <span class="citation">Robert (<a href="#ref-robert1995simulation">1995</a>)</span>).</p>
<hr />
<div class="sourceCode" id="cb54"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb54-1"><a href="C.html#cb54-1" tabindex="-1"></a><span class="dt">double</span> dtnorm<span class="op">(</span><span class="dt">double</span> x<span class="op">,</span></span>
<span id="cb54-2"><a href="C.html#cb54-2" tabindex="-1"></a>              <span class="dt">double</span> min<span class="op">,</span></span>
<span id="cb54-3"><a href="C.html#cb54-3" tabindex="-1"></a>              <span class="dt">double</span> max<span class="op">);</span></span></code></pre></div>
<p>Evaluates the log of the standard truncated normal density, with bounds given by <code>min</code> and <code>max</code>, at the point <code>x</code>.</p>
<hr />
<div class="sourceCode" id="cb55"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb55-1"><a href="C.html#cb55-1" tabindex="-1"></a><span class="dt">double</span> rtnorm<span class="op">(</span>RandomNumberGenerator <span class="op">&amp;</span>rng<span class="op">,</span></span>
<span id="cb55-2"><a href="C.html#cb55-2" tabindex="-1"></a>              <span class="dt">double</span> mean<span class="op">,</span></span>
<span id="cb55-3"><a href="C.html#cb55-3" tabindex="-1"></a>              <span class="dt">double</span> sd<span class="op">,</span></span>
<span id="cb55-4"><a href="C.html#cb55-4" tabindex="-1"></a>              <span class="dt">double</span> min<span class="op">,</span></span>
<span id="cb55-5"><a href="C.html#cb55-5" tabindex="-1"></a>              <span class="dt">double</span> max<span class="op">);</span></span></code></pre></div>
<p>Generates a random number from the truncated normal distribution with mean <code>mean</code> and standard deviation <code>sd</code>, with bounds given by <code>min</code> and <code>max</code>.</p>
<hr />
<div class="sourceCode" id="cb56"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb56-1"><a href="C.html#cb56-1" tabindex="-1"></a>arma<span class="op">::</span>mat rtnorm<span class="op">(</span>RandomNumberGenerator <span class="op">&amp;</span>rng<span class="op">,</span></span>
<span id="cb56-2"><a href="C.html#cb56-2" tabindex="-1"></a>                 <span class="dt">size_t</span> n<span class="op">,</span></span>
<span id="cb56-3"><a href="C.html#cb56-3" tabindex="-1"></a>                 <span class="dt">double</span> mean<span class="op">,</span></span>
<span id="cb56-4"><a href="C.html#cb56-4" tabindex="-1"></a>                 <span class="dt">double</span> sd<span class="op">,</span></span>
<span id="cb56-5"><a href="C.html#cb56-5" tabindex="-1"></a>                 <span class="dt">double</span> min<span class="op">,</span></span>
<span id="cb56-6"><a href="C.html#cb56-6" tabindex="-1"></a>                 <span class="dt">double</span> max<span class="op">);</span></span></code></pre></div>
<p>Generates <code>n</code> random numbers from the truncated normal distribution with mean <code>mean</code> and standard deviation <code>sd</code>, with bounds given by <code>min</code> and <code>max</code>.</p>
<hr />
<div class="sourceCode" id="cb57"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb57-1"><a href="C.html#cb57-1" tabindex="-1"></a>arma<span class="op">::</span>mat rtnorm<span class="op">(</span>RandomNumberGenerator <span class="op">&amp;</span>rng<span class="op">,</span></span>
<span id="cb57-2"><a href="C.html#cb57-2" tabindex="-1"></a>                 <span class="bu">std::</span>pair<span class="op">&lt;</span><span class="dt">size_t</span><span class="op">,</span><span class="dt">size_t</span><span class="op">&gt;</span> dimensions<span class="op">,</span></span>
<span id="cb57-3"><a href="C.html#cb57-3" tabindex="-1"></a>                 <span class="dt">double</span> mean<span class="op">,</span></span>
<span id="cb57-4"><a href="C.html#cb57-4" tabindex="-1"></a>                 <span class="dt">double</span> sd<span class="op">,</span></span>
<span id="cb57-5"><a href="C.html#cb57-5" tabindex="-1"></a>                 <span class="dt">double</span> min<span class="op">,</span></span>
<span id="cb57-6"><a href="C.html#cb57-6" tabindex="-1"></a>                 <span class="dt">double</span> max<span class="op">);</span></span></code></pre></div>
<p>Generates a matrix (of dimension given by <code>dimensions</code>) of random numbers from the truncated normal distribution with mean <code>mean</code> and standard deviation <code>sd</code>, with bounds given by <code>min</code> and <code>max</code>.</p>
<hr />
<div class="sourceCode" id="cb58"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb58-1"><a href="C.html#cb58-1" tabindex="-1"></a><span class="dt">double</span> dtnorm<span class="op">(</span><span class="dt">double</span> x<span class="op">,</span></span>
<span id="cb58-2"><a href="C.html#cb58-2" tabindex="-1"></a>              <span class="dt">double</span> mean<span class="op">,</span></span>
<span id="cb58-3"><a href="C.html#cb58-3" tabindex="-1"></a>              <span class="dt">double</span> sd<span class="op">,</span></span>
<span id="cb58-4"><a href="C.html#cb58-4" tabindex="-1"></a>              <span class="dt">double</span> min<span class="op">,</span></span>
<span id="cb58-5"><a href="C.html#cb58-5" tabindex="-1"></a>              <span class="dt">double</span> max<span class="op">);</span></span></code></pre></div>
<p>Evaluates the log of the truncated normal density with mean <code>mean</code> and standard deviation <code>sd</code>, with bounds given by <code>min</code> and <code>max</code>, at the point <code>x</code>.</p>
<hr />
<div class="sourceCode" id="cb59"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb59-1"><a href="C.html#cb59-1" tabindex="-1"></a>arma<span class="op">::</span>colvec dtnorm<span class="op">(</span><span class="at">const</span> arma<span class="op">::</span>colvec <span class="op">&amp;</span>x<span class="op">,</span></span>
<span id="cb59-2"><a href="C.html#cb59-2" tabindex="-1"></a>                    <span class="dt">double</span> mean<span class="op">,</span></span>
<span id="cb59-3"><a href="C.html#cb59-3" tabindex="-1"></a>                    <span class="dt">double</span> sd<span class="op">,</span></span>
<span id="cb59-4"><a href="C.html#cb59-4" tabindex="-1"></a>                    <span class="dt">double</span> min<span class="op">,</span></span>
<span id="cb59-5"><a href="C.html#cb59-5" tabindex="-1"></a>                    <span class="dt">double</span> max<span class="op">);</span></span></code></pre></div>
<p>Evaluates the log of the truncated normal density with mean <code>mean</code> and standard deviation <code>sd</code>, with bounds given by <code>min</code> and <code>max</code>, at the vector of points <code>x</code>, returning a vector.</p>
<hr />
<div class="sourceCode" id="cb60"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb60-1"><a href="C.html#cb60-1" tabindex="-1"></a>arma<span class="op">::</span>colvec rtmvnorm<span class="op">(</span>RandomNumberGenerator <span class="op">&amp;</span>rng<span class="op">,</span></span>
<span id="cb60-2"><a href="C.html#cb60-2" tabindex="-1"></a>                      <span class="at">const</span> arma<span class="op">::</span>colvec <span class="op">&amp;</span>mu<span class="op">,</span></span>
<span id="cb60-3"><a href="C.html#cb60-3" tabindex="-1"></a>                      <span class="at">const</span> arma<span class="op">::</span>mat <span class="op">&amp;</span>Sigma<span class="op">,</span></span>
<span id="cb60-4"><a href="C.html#cb60-4" tabindex="-1"></a>                      <span class="at">const</span> arma<span class="op">::</span>colvec <span class="op">&amp;</span>min<span class="op">,</span></span>
<span id="cb60-5"><a href="C.html#cb60-5" tabindex="-1"></a>                      <span class="at">const</span> arma<span class="op">::</span>colvec <span class="op">&amp;</span>max<span class="op">);</span></span></code></pre></div>
<p>Generates a random vector from the truncated multivariate normal distribution with mean <code>mu</code> and covariance <code>Sigma</code>, with bounds given by <code>min</code> and <code>max</code>. A simple rejection sampler is used for the implementation.</p>
<hr />
<div class="sourceCode" id="cb61"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb61-1"><a href="C.html#cb61-1" tabindex="-1"></a>arma<span class="op">::</span>mat rtmvnorm<span class="op">(</span>RandomNumberGenerator <span class="op">&amp;</span>rng<span class="op">,</span></span>
<span id="cb61-2"><a href="C.html#cb61-2" tabindex="-1"></a>                   <span class="dt">size_t</span> n<span class="op">,</span></span>
<span id="cb61-3"><a href="C.html#cb61-3" tabindex="-1"></a>                   <span class="at">const</span> arma<span class="op">::</span>colvec <span class="op">&amp;</span>mu<span class="op">,</span></span>
<span id="cb61-4"><a href="C.html#cb61-4" tabindex="-1"></a>                   <span class="at">const</span> arma<span class="op">::</span>mat <span class="op">&amp;</span>Sigma<span class="op">,</span></span>
<span id="cb61-5"><a href="C.html#cb61-5" tabindex="-1"></a>                   <span class="at">const</span> arma<span class="op">::</span>colvec <span class="op">&amp;</span>min<span class="op">,</span></span>
<span id="cb61-6"><a href="C.html#cb61-6" tabindex="-1"></a>                   <span class="at">const</span> arma<span class="op">::</span>colvec <span class="op">&amp;</span>max<span class="op">);</span></span></code></pre></div>
<p>Generates <code>n</code> random vectors from the truncated multivariate normal distribution with mean <code>mu</code> and covariance <code>Sigma</code>, with bounds given by <code>min</code> and <code>max</code>, stored in a <span class="math inline">\(d\times n\)</span> matrix, where <span class="math inline">\(d\)</span> is the dimension of the multivariate Gaussian (determined by the size of the inputted mean and covariance).</p>
</div>
<div id="poisson-distribution" class="section level4 hasAnchor" number="2.3.3.10">
<h4><span class="header-section-number">2.3.3.10</span> Poisson distribution<a href="C.html#poisson-distribution" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<hr />
<div class="sourceCode" id="cb62"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb62-1"><a href="C.html#cb62-1" tabindex="-1"></a><span class="dt">int</span> rpois<span class="op">(</span>RandomNumberGenerator <span class="op">&amp;</span>rng<span class="op">,</span></span>
<span id="cb62-2"><a href="C.html#cb62-2" tabindex="-1"></a>          <span class="dt">double</span> rate<span class="op">);</span></span></code></pre></div>
<p>Generates a random number from the Poisson distribution with rate <code>rate</code>.</p>
<hr />
<div class="sourceCode" id="cb63"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb63-1"><a href="C.html#cb63-1" tabindex="-1"></a>arma<span class="op">::</span>colvec rpois<span class="op">(</span>RandomNumberGenerator <span class="op">&amp;</span>rng<span class="op">,</span></span>
<span id="cb63-2"><a href="C.html#cb63-2" tabindex="-1"></a>                   <span class="dt">size_t</span> n<span class="op">,</span></span>
<span id="cb63-3"><a href="C.html#cb63-3" tabindex="-1"></a>                   <span class="dt">double</span> rate<span class="op">);</span></span></code></pre></div>
<p>Generates <code>n</code> random numbers from the Poisson distribution with rate <code>rate</code>.</p>
<hr />
<div class="sourceCode" id="cb64"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb64-1"><a href="C.html#cb64-1" tabindex="-1"></a><span class="dt">double</span> dpois<span class="op">(</span><span class="dt">double</span> x<span class="op">,</span></span>
<span id="cb64-2"><a href="C.html#cb64-2" tabindex="-1"></a>             <span class="dt">double</span> rate<span class="op">);</span></span></code></pre></div>
<p>Evaluates the log of the Poisson mass function with rate <code>rate</code> at the point <code>x</code>.</p>
</div>
<div id="uniform-distribution-continuous" class="section level4 hasAnchor" number="2.3.3.11">
<h4><span class="header-section-number">2.3.3.11</span> Uniform distribution (continuous)<a href="C.html#uniform-distribution-continuous" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<hr />
<div class="sourceCode" id="cb65"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb65-1"><a href="C.html#cb65-1" tabindex="-1"></a><span class="dt">double</span> runif<span class="op">(</span>RandomNumberGenerator <span class="op">&amp;</span>rng<span class="op">);</span></span></code></pre></div>
<p>Generates a random number from the uniform distribution between 0 and 1.</p>
<hr />
<div class="sourceCode" id="cb66"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb66-1"><a href="C.html#cb66-1" tabindex="-1"></a><span class="dt">double</span> runif<span class="op">(</span>RandomNumberGenerator <span class="op">&amp;</span>rng<span class="op">,</span></span>
<span id="cb66-2"><a href="C.html#cb66-2" tabindex="-1"></a>             <span class="dt">double</span> lower<span class="op">,</span></span>
<span id="cb66-3"><a href="C.html#cb66-3" tabindex="-1"></a>             <span class="dt">double</span> upper<span class="op">);</span></span></code></pre></div>
<p>Generates a random number from the uniform distribution between <code>lower</code> and <code>upper</code>.</p>
<hr />
<div class="sourceCode" id="cb67"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb67-1"><a href="C.html#cb67-1" tabindex="-1"></a>arma<span class="op">::</span>mat runif<span class="op">(</span>RandomNumberGenerator <span class="op">&amp;</span>rng<span class="op">,</span></span>
<span id="cb67-2"><a href="C.html#cb67-2" tabindex="-1"></a>                <span class="at">const</span> arma<span class="op">::</span>mat <span class="op">&amp;</span>lower<span class="op">,</span></span>
<span id="cb67-3"><a href="C.html#cb67-3" tabindex="-1"></a>                <span class="at">const</span> arma<span class="op">::</span>mat <span class="op">&amp;</span>upper<span class="op">);</span></span></code></pre></div>
<p>Generates a matrix of random numbers, where the <span class="math inline">\((i,j)\)</span>th element is drawn from the uniform distribution between the <span class="math inline">\((i,j)\)</span>th element of <code>lower</code> and the <span class="math inline">\((i,j)\)</span>th element of <code>upper</code>.</p>
<hr />
<div class="sourceCode" id="cb68"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb68-1"><a href="C.html#cb68-1" tabindex="-1"></a>arma<span class="op">::</span>rowvec multiple_runif<span class="op">(</span>RandomNumberGenerator <span class="op">&amp;</span>rng<span class="op">,</span></span>
<span id="cb68-2"><a href="C.html#cb68-2" tabindex="-1"></a>                            <span class="dt">size_t</span> n<span class="op">);</span></span></code></pre></div>
<p>Generates <code>n</code> random numbers from the uniform distribution between 0 and 1, and stores them in a row vector.</p>
<hr />
<div class="sourceCode" id="cb69"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb69-1"><a href="C.html#cb69-1" tabindex="-1"></a>arma<span class="op">::</span>rowvec multiple_runif<span class="op">(</span>RandomNumberGenerator <span class="op">&amp;</span>rng<span class="op">,</span></span>
<span id="cb69-2"><a href="C.html#cb69-2" tabindex="-1"></a>                            <span class="dt">size_t</span> n<span class="op">,</span></span>
<span id="cb69-3"><a href="C.html#cb69-3" tabindex="-1"></a>                            <span class="dt">double</span> lower<span class="op">,</span></span>
<span id="cb69-4"><a href="C.html#cb69-4" tabindex="-1"></a>                            <span class="dt">double</span> upper<span class="op">);</span></span></code></pre></div>
<p>Generates <code>n</code> random numbers from the uniform distribution between <code>lower</code> and <code>upper</code>, and stores them in a row vector.</p>
<hr />
<div class="sourceCode" id="cb70"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb70-1"><a href="C.html#cb70-1" tabindex="-1"></a><span class="dt">double</span> dunif<span class="op">(</span><span class="dt">double</span> x<span class="op">);</span></span></code></pre></div>
<p>Evaluates the log of the uniform density between 0 and 1 at <code>x</code>.</p>
<hr />
<div class="sourceCode" id="cb71"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb71-1"><a href="C.html#cb71-1" tabindex="-1"></a><span class="dt">double</span> dunif<span class="op">(</span><span class="dt">double</span> x<span class="op">,</span></span>
<span id="cb71-2"><a href="C.html#cb71-2" tabindex="-1"></a>             <span class="dt">double</span> lower<span class="op">,</span></span>
<span id="cb71-3"><a href="C.html#cb71-3" tabindex="-1"></a>             <span class="dt">double</span> upper<span class="op">);</span></span></code></pre></div>
<p>Evaluates the log of the uniform density between <code>lower</code> and <code>upper</code> at <code>x</code>.</p>
<hr />
<div class="sourceCode" id="cb72"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb72-1"><a href="C.html#cb72-1" tabindex="-1"></a><span class="dt">double</span> dunif<span class="op">(</span><span class="at">const</span> arma<span class="op">::</span>mat <span class="op">&amp;</span>x<span class="op">,</span></span>
<span id="cb72-2"><a href="C.html#cb72-2" tabindex="-1"></a>             <span class="at">const</span> arma<span class="op">::</span>mat <span class="op">&amp;</span>lower<span class="op">,</span></span>
<span id="cb72-3"><a href="C.html#cb72-3" tabindex="-1"></a>             <span class="at">const</span> arma<span class="op">::</span>mat <span class="op">&amp;</span>upper<span class="op">);</span></span></code></pre></div>
<p>For the <span class="math inline">\((i,j)\)</span>th element of <code>x</code>, evaluate the log of the uniform density between the <span class="math inline">\((i,j)\)</span>th element of <code>lower</code> and the <span class="math inline">\((i,j)\)</span>th element of <code>upper</code>, then take the sum of the result (i.e. the product of independent uniform densities).</p>
</div>
</div>
</div>
<h3>References<a href="references.html#references" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-BH" class="csl-entry">
Eddelbuettel, Dirk, John W. Emerson, and Michael J. Kane. 2024. <em>BH: Boost c++ Header Files</em>. <a href="https://CRAN.R-project.org/package=BH">https://CRAN.R-project.org/package=BH</a>.
</div>
<div id="ref-eddelbuettel2014rcpparmadillo" class="csl-entry">
Eddelbuettel, Dirk, and Conrad Sanderson. 2014. <span>“RcppArmadillo: Accelerating <span>R</span> with High-Performance <span>C</span>++ Linear Algebra.”</span> <em>Computational Statistics &amp; Data Analysis</em> 71: 1054–63.
</div>
<div id="ref-MVN" class="csl-entry">
Korkmaz, Selcuk, Dincer Goksuluk, and Gokmen Zararsiz. 2014. <span>“MVN: An r Package for Assessing Multivariate Normality.”</span> <em>The R Journal</em> 6 (2): 151–62. <a href="https://journal.r-project.org/archive/2014-2/korkmaz-goksuluk-zararsiz.pdf">https://journal.r-project.org/archive/2014-2/korkmaz-goksuluk-zararsiz.pdf</a>.
</div>
<div id="ref-robert1995simulation" class="csl-entry">
Robert, Christian P. 1995. <span>“Simulation of Truncated Normal Variables.”</span> <em>Statistics and <span>C</span>omputing</em> 5: 121–25.
</div>
<div id="ref-dqrng" class="csl-entry">
Stubner, Ralf. 2023. <em>Dqrng: Fast Pseudo Random Number Generators</em>. <a href="https://CRAN.R-project.org/package=dqrng">https://CRAN.R-project.org/package=dqrng</a>.
</div>
</div>
<div class="footnotes">
<hr />
<ol start="3">
<li id="fn3"><p>In fact this is also true for a whole ilike file. The headers that need to be included for the ilike package can be found in the package <code>inst/include</code> directory. Other headers from other R packages that ilike depends on are also required (see the <code>LinkingTo</code> section in the package <code>DESCRIPTION</code> file.<a href="C.html#fnref3" class="footnote-back">↩︎</a></p></li>
<li id="fn4"><p>If the argument, for example, seem mysterious to you, don’t worry about this just yet. This documentation should tell you most of what you need to know to get started. If you want to understand more, <a href="https://cplusplus.com/doc/tutorial/functions/">this tutorial</a> is a reasonable starting point.<a href="C.html#fnref4" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="compiling.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="R.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/richardgeveritt/ilike_documentation/edit/master/01-ilike-files.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["ilike docs.pdf", "ilike docs.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>

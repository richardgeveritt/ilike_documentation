<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>2.3 MCMC | ilike documentation</title>
  <meta name="description" content="Documentation for the ilike R package." />
  <meta name="generator" content="bookdown 0.37 and GitBook 2.6.7" />

  <meta property="og:title" content="2.3 MCMC | ilike documentation" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="Documentation for the ilike R package." />
  <meta name="github-repo" content="richardgeveritt/ilike_documentation" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="2.3 MCMC | ilike documentation" />
  
  <meta name="twitter:description" content="Documentation for the ilike R package." />
  

<meta name="author" content="Richard G. Everitt" />


<meta name="date" content="2025-02-11" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="inference-is.html"/>
<link rel="next" href="inference-smc.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>
<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">ilike documentation</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Preface</a>
<ul>
<li class="chapter" data-level="1.1" data-path="toy-example.html"><a href="toy-example.html"><i class="fa fa-check"></i><b>1.1</b> Example</a>
<ul>
<li class="chapter" data-level="1.1.1" data-path="toy-example.html"><a href="toy-example.html#recipe"><i class="fa fa-check"></i><b>1.1.1</b> Recipe</a></li>
<li class="chapter" data-level="1.1.2" data-path="toy-example.html"><a href="toy-example.html#ilike-file"><i class="fa fa-check"></i><b>1.1.2</b> ilike file</a></li>
<li class="chapter" data-level="1.1.3" data-path="toy-example.html"><a href="toy-example.html#running-mcmc"><i class="fa fa-check"></i><b>1.1.3</b> Running MCMC</a></li>
<li class="chapter" data-level="1.1.4" data-path="toy-example.html"><a href="toy-example.html#visualising-the-output"><i class="fa fa-check"></i><b>1.1.4</b> Visualising the output</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="inference.html"><a href="inference.html"><i class="fa fa-check"></i><b>2</b> Inference algorithms</a>
<ul>
<li class="chapter" data-level="2.1" data-path="inference-arguments.html"><a href="inference-arguments.html"><i class="fa fa-check"></i><b>2.1</b> Inference algorithm arguments</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="inference-arguments.html"><a href="inference-arguments.html#recipe-required"><i class="fa fa-check"></i><b>2.1.1</b> <code>recipe</code> (required)</a></li>
<li class="chapter" data-level="2.1.2" data-path="inference-arguments.html"><a href="inference-arguments.html#results_name-required"><i class="fa fa-check"></i><b>2.1.2</b> <code>results_name</code> (required)</a></li>
<li class="chapter" data-level="2.1.3" data-path="inference-arguments.html"><a href="inference-arguments.html#results_path-optional"><i class="fa fa-check"></i><b>2.1.3</b> <code>results_path</code> (optional)</a></li>
<li class="chapter" data-level="2.1.4" data-path="inference-arguments.html"><a href="inference-arguments.html#model_parameter_list-optional"><i class="fa fa-check"></i><b>2.1.4</b> <code>model_parameter_list</code> (optional)</a></li>
<li class="chapter" data-level="2.1.5" data-path="inference-arguments.html"><a href="inference-arguments.html#fixed_parameter_list-optional"><i class="fa fa-check"></i><b>2.1.5</b> <code>fixed_parameter_list</code> (optional)</a></li>
<li class="chapter" data-level="2.1.6" data-path="inference-arguments.html"><a href="inference-arguments.html#external_packages-optional"><i class="fa fa-check"></i><b>2.1.6</b> <code>external_packages</code> (optional)</a></li>
<li class="chapter" data-level="2.1.7" data-path="inference-arguments.html"><a href="inference-arguments.html#julia_bin_dir-optional"><i class="fa fa-check"></i><b>2.1.7</b> <code>julia_bin_dir</code> (optional)</a></li>
<li class="chapter" data-level="2.1.8" data-path="inference-arguments.html"><a href="inference-arguments.html#julia_required_libraries-optional"><i class="fa fa-check"></i><b>2.1.8</b> <code>julia_required_libraries</code> (optional)</a></li>
<li class="chapter" data-level="2.1.9" data-path="inference-arguments.html"><a href="inference-arguments.html#keep_temporary_model_code-optional"><i class="fa fa-check"></i><b>2.1.9</b> <code>keep_temporary_model_code</code> (optional)</a></li>
<li class="chapter" data-level="2.1.10" data-path="inference-arguments.html"><a href="inference-arguments.html#seed-optional"><i class="fa fa-check"></i><b>2.1.10</b> <code>seed</code> (optional)</a></li>
<li class="chapter" data-level="2.1.11" data-path="inference-arguments.html"><a href="inference-arguments.html#parallel-optional"><i class="fa fa-check"></i><b>2.1.11</b> <code>parallel</code> (optional)</a></li>
<li class="chapter" data-level="2.1.12" data-path="inference-arguments.html"><a href="inference-arguments.html#grain_size-optional"><i class="fa fa-check"></i><b>2.1.12</b> <code>grain_size</code> (optional)</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="inference-is.html"><a href="inference-is.html"><i class="fa fa-check"></i><b>2.2</b> Importance sampling</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="inference-is.html"><a href="inference-is.html#algorithm"><i class="fa fa-check"></i><b>2.2.1</b> Algorithm</a></li>
<li class="chapter" data-level="2.2.2" data-path="inference-is.html"><a href="inference-is.html#ilike-recipe-requirements"><i class="fa fa-check"></i><b>2.2.2</b> ilike recipe requirements</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="inference-mcmc.html"><a href="inference-mcmc.html"><i class="fa fa-check"></i><b>2.3</b> MCMC</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="inference-mcmc.html"><a href="inference-mcmc.html#algorithm-1"><i class="fa fa-check"></i><b>2.3.1</b> Algorithm</a></li>
<li class="chapter" data-level="2.3.2" data-path="inference-mcmc.html"><a href="inference-mcmc.html#ilike-recipe-requirements-1"><i class="fa fa-check"></i><b>2.3.2</b> ilike recipe requirements</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="inference-smc.html"><a href="inference-smc.html"><i class="fa fa-check"></i><b>2.4</b> SMC with MCMC moves</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="inference-smc.html"><a href="inference-smc.html#ilike-recipe-requirements-2"><i class="fa fa-check"></i><b>2.4.1</b> ilike recipe requirements</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="inference-kf.html"><a href="inference-kf.html"><i class="fa fa-check"></i><b>2.5</b> Kalman filters</a>
<ul>
<li class="chapter" data-level="2.5.1" data-path="inference-kf.html"><a href="inference-kf.html#ilike-recipe-requirements-3"><i class="fa fa-check"></i><b>2.5.1</b> ilike recipe requirements</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="inference-pf.html"><a href="inference-pf.html"><i class="fa fa-check"></i><b>2.6</b> Particle filters</a>
<ul>
<li class="chapter" data-level="2.6.1" data-path="inference-pf.html"><a href="inference-pf.html#ilike-recipe-requirements-4"><i class="fa fa-check"></i><b>2.6.1</b> ilike recipe requirements</a></li>
</ul></li>
<li class="chapter" data-level="2.7" data-path="inference-enkf.html"><a href="inference-enkf.html"><i class="fa fa-check"></i><b>2.7</b> Ensemble Kalman filters</a>
<ul>
<li class="chapter" data-level="2.7.1" data-path="inference-enkf.html"><a href="inference-enkf.html#ilike-recipe-requirements-5"><i class="fa fa-check"></i><b>2.7.1</b> ilike recipe requirements</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="ilike-files.html"><a href="ilike-files.html"><i class="fa fa-check"></i><b>3</b> ilike files</a>
<ul>
<li class="chapter" data-level="3.1" data-path="file-structure.html"><a href="file-structure.html"><i class="fa fa-check"></i><b>3.1</b> File structure</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="file-structure.html"><a href="file-structure.html#blocks-automatically"><i class="fa fa-check"></i><b>3.1.1</b> Specifying blocks automatically</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="compiling.html"><a href="compiling.html"><i class="fa fa-check"></i><b>3.2</b> Compiling an ilike file</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="compiling.html"><a href="compiling.html#compiler-output"><i class="fa fa-check"></i><b>3.2.1</b> Compiler output</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="C.html"><a href="C.html"><i class="fa fa-check"></i><b>3.3</b> C++ functions</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="C.html"><a href="C.html#including-additional-code"><i class="fa fa-check"></i><b>3.3.1</b> Including additional code</a></li>
<li class="chapter" data-level="3.3.2" data-path="C.html"><a href="C.html#ilike-cpp-classes"><i class="fa fa-check"></i><b>3.3.2</b> ilike C++ classes</a></li>
<li class="chapter" data-level="3.3.3" data-path="C.html"><a href="C.html#ilike-cpp-functions"><i class="fa fa-check"></i><b>3.3.3</b> ilike C++ functions</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="R.html"><a href="R.html"><i class="fa fa-check"></i><b>3.4</b> R functions</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="R.html"><a href="R.html#function-arguments-for-r-functions"><i class="fa fa-check"></i><b>3.4.1</b> Function arguments for R functions</a></li>
<li class="chapter" data-level="3.4.2" data-path="R.html"><a href="R.html#function-headers-for-r-functions"><i class="fa fa-check"></i><b>3.4.2</b> Function headers for R functions</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="python.html"><a href="python.html"><i class="fa fa-check"></i><b>3.5</b> Python functions</a>
<ul>
<li class="chapter" data-level="3.5.1" data-path="python.html"><a href="python.html#using-jax-to-calculate-gradients"><i class="fa fa-check"></i><b>3.5.1</b> Using jax to calculate gradients</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="julia.html"><a href="julia.html"><i class="fa fa-check"></i><b>3.6</b> Julia functions</a></li>
<li class="chapter" data-level="3.7" data-path="ilike-functions.html"><a href="ilike-functions.html"><i class="fa fa-check"></i><b>3.7</b> ilike functions</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="models.html"><a href="models.html"><i class="fa fa-check"></i><b>4</b> Models</a>
<ul>
<li class="chapter" data-level="4.1" data-path="data.html"><a href="data.html"><i class="fa fa-check"></i><b>4.1</b> Data</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="data.html"><a href="data.html#data-1"><i class="fa fa-check"></i><b>4.1.1</b> data</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="user-defined-prior.html"><a href="user-defined-prior.html"><i class="fa fa-check"></i><b>4.2</b> User-defined prior</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="user-defined-prior.html"><a href="user-defined-prior.html#evaluate_log_prior"><i class="fa fa-check"></i><b>4.2.1</b> evaluate_log_prior</a></li>
<li class="chapter" data-level="4.2.2" data-path="user-defined-prior.html"><a href="user-defined-prior.html#simulate_prior"><i class="fa fa-check"></i><b>4.2.2</b> simulate_prior</a></li>
<li class="chapter" data-level="4.2.3" data-path="user-defined-prior.html"><a href="user-defined-prior.html#evaluate_gradient_log_prior"><i class="fa fa-check"></i><b>4.2.3</b> evaluate_gradient_log_prior</a></li>
<li class="chapter" data-level="4.2.4" data-path="user-defined-prior.html"><a href="user-defined-prior.html#evaluate_second_gradient_log_prior"><i class="fa fa-check"></i><b>4.2.4</b> evaluate_second_gradient_log_prior</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="ilike-prior.html"><a href="ilike-prior.html"><i class="fa fa-check"></i><b>4.3</b> Built-in prior</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="ilike-prior.html"><a href="ilike-prior.html#prior"><i class="fa fa-check"></i><b>4.3.1</b> prior</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="user-defined-likelihood.html"><a href="user-defined-likelihood.html"><i class="fa fa-check"></i><b>4.4</b> User-defined likelihood</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="user-defined-likelihood.html"><a href="user-defined-likelihood.html#evaluate_log_likelihood"><i class="fa fa-check"></i><b>4.4.1</b> evaluate_log_likelihood</a></li>
<li class="chapter" data-level="4.4.2" data-path="user-defined-likelihood.html"><a href="user-defined-likelihood.html#evaluate_gradient_log_likelihood"><i class="fa fa-check"></i><b>4.4.2</b> evaluate_gradient_log_likelihood</a></li>
<li class="chapter" data-level="4.4.3" data-path="user-defined-likelihood.html"><a href="user-defined-likelihood.html#evaluate_second_gradient_log_likelihood"><i class="fa fa-check"></i><b>4.4.3</b> evaluate_second_gradient_log_likelihood</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="linear-gaussian-model.html"><a href="linear-gaussian-model.html"><i class="fa fa-check"></i><b>4.5</b> Linear-Gaussian model</a>
<ul>
<li class="chapter" data-level="4.5.1" data-path="linear-gaussian-model.html"><a href="linear-gaussian-model.html#linear_gaussian_data_variable"><i class="fa fa-check"></i><b>4.5.1</b> linear_gaussian_data_variable</a></li>
<li class="chapter" data-level="4.5.2" data-path="linear-gaussian-model.html"><a href="linear-gaussian-model.html#linear_gaussian_data_state_variable"><i class="fa fa-check"></i><b>4.5.2</b> linear_gaussian_data_state_variable</a></li>
<li class="chapter" data-level="4.5.3" data-path="linear-gaussian-model.html"><a href="linear-gaussian-model.html#linear_gaussian_data_matrix"><i class="fa fa-check"></i><b>4.5.3</b> linear_gaussian_data_matrix</a></li>
<li class="chapter" data-level="4.5.4" data-path="linear-gaussian-model.html"><a href="linear-gaussian-model.html#linear_gaussian_data_covariance"><i class="fa fa-check"></i><b>4.5.4</b> linear_gaussian_data_covariance</a></li>
<li class="chapter" data-level="4.5.5" data-path="linear-gaussian-model.html"><a href="linear-gaussian-model.html#linear_gaussian_data_model"><i class="fa fa-check"></i><b>4.5.5</b> linear_gaussian_data_model</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="nonlinear-gaussian-model.html"><a href="nonlinear-gaussian-model.html"><i class="fa fa-check"></i><b>4.6</b> Nonlinear-Gaussian model</a>
<ul>
<li class="chapter" data-level="4.6.1" data-path="nonlinear-gaussian-model.html"><a href="nonlinear-gaussian-model.html#nonlinear_gaussian_data_variable"><i class="fa fa-check"></i><b>4.6.1</b> nonlinear_gaussian_data_variable</a></li>
<li class="chapter" data-level="4.6.2" data-path="nonlinear-gaussian-model.html"><a href="nonlinear-gaussian-model.html#nonlinear_gaussian_data_function"><i class="fa fa-check"></i><b>4.6.2</b> nonlinear_gaussian_data_function</a></li>
<li class="chapter" data-level="4.6.3" data-path="nonlinear-gaussian-model.html"><a href="nonlinear-gaussian-model.html#nonlinear_gaussian_data_covariance"><i class="fa fa-check"></i><b>4.6.3</b> nonlinear_gaussian_data_covariance</a></li>
</ul></li>
<li class="chapter" data-level="4.7" data-path="simulation-based-likelihood.html"><a href="simulation-based-likelihood.html"><i class="fa fa-check"></i><b>4.7</b> Simulation-based likelihood</a>
<ul>
<li class="chapter" data-level="4.7.1" data-path="simulation-based-likelihood.html"><a href="simulation-based-likelihood.html#simulate_data_model"><i class="fa fa-check"></i><b>4.7.1</b> simulate_data_model</a></li>
<li class="chapter" data-level="4.7.2" data-path="simulation-based-likelihood.html"><a href="simulation-based-likelihood.html#data_variable"><i class="fa fa-check"></i><b>4.7.2</b> data_variable</a></li>
<li class="chapter" data-level="4.7.3" data-path="simulation-based-likelihood.html"><a href="simulation-based-likelihood.html#summary_statistics"><i class="fa fa-check"></i><b>4.7.3</b> summary_statistics</a></li>
<li class="chapter" data-level="4.7.4" data-path="simulation-based-likelihood.html"><a href="simulation-based-likelihood.html#sbi_likelihood"><i class="fa fa-check"></i><b>4.7.4</b> sbi_likelihood</a></li>
</ul></li>
<li class="chapter" data-level="4.8" data-path="algorithmic-likelihood.html"><a href="algorithmic-likelihood.html"><i class="fa fa-check"></i><b>4.8</b> Algorithmic likelihood</a>
<ul>
<li class="chapter" data-level="4.8.1" data-path="algorithmic-likelihood.html"><a href="algorithmic-likelihood.html#algorithmic_likelihood"><i class="fa fa-check"></i><b>4.8.1</b> algorithmic_likelihood</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="mcmc.html"><a href="mcmc.html"><i class="fa fa-check"></i><b>5</b> Markov chain Monte Carlo</a>
<ul>
<li class="chapter" data-level="5.1" data-path="mcmc-termination.html"><a href="mcmc-termination.html"><i class="fa fa-check"></i><b>5.1</b> MCMC termination</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="mcmc-termination.html"><a href="mcmc-termination.html#mcmc_termination"><i class="fa fa-check"></i><b>5.1.1</b> mcmc_termination</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="mcmc-sweeps.html"><a href="mcmc-sweeps.html"><i class="fa fa-check"></i><b>5.2</b> MCMC sweeps</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="mcmc-sweeps.html"><a href="mcmc-sweeps.html#mcmc_weights"><i class="fa fa-check"></i><b>5.2.1</b> mcmc_weights</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="selecting-factors.html"><a href="selecting-factors.html"><i class="fa fa-check"></i><b>5.3</b> Selecting factors</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="selecting-factors.html"><a href="selecting-factors.html#m_factor_index"><i class="fa fa-check"></i><b>5.3.1</b> m_factor_index</a></li>
<li class="chapter" data-level="5.3.2" data-path="selecting-factors.html"><a href="selecting-factors.html#imh_factor_index"><i class="fa fa-check"></i><b>5.3.2</b> imh_factor_index</a></li>
<li class="chapter" data-level="5.3.3" data-path="selecting-factors.html"><a href="selecting-factors.html#mh_factor_index"><i class="fa fa-check"></i><b>5.3.3</b> mh_factor_index</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="user-defined-metropolis-proposals.html"><a href="user-defined-metropolis-proposals.html"><i class="fa fa-check"></i><b>5.4</b> User-defined Metropolis proposals</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="user-defined-metropolis-proposals.html"><a href="user-defined-metropolis-proposals.html#simulate_m_proposal"><i class="fa fa-check"></i><b>5.4.1</b> simulate_m_proposal</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="built-in-metropolis-proposals.html"><a href="built-in-metropolis-proposals.html"><i class="fa fa-check"></i><b>5.5</b> Built-in Metropolis proposals</a>
<ul>
<li class="chapter" data-level="5.5.1" data-path="built-in-metropolis-proposals.html"><a href="built-in-metropolis-proposals.html#m_proposal"><i class="fa fa-check"></i><b>5.5.1</b> m_proposal</a></li>
</ul></li>
<li class="chapter" data-level="5.6" data-path="user-defined-independent-mh-proposals.html"><a href="user-defined-independent-mh-proposals.html"><i class="fa fa-check"></i><b>5.6</b> User-defined independent MH proposals</a>
<ul>
<li class="chapter" data-level="5.6.1" data-path="user-defined-independent-mh-proposals.html"><a href="user-defined-independent-mh-proposals.html#simulate_imh_proposal"><i class="fa fa-check"></i><b>5.6.1</b> simulate_imh_proposal</a></li>
<li class="chapter" data-level="5.6.2" data-path="user-defined-independent-mh-proposals.html"><a href="user-defined-independent-mh-proposals.html#evaluate_log_imh_proposal"><i class="fa fa-check"></i><b>5.6.2</b> evaluate_log_imh_proposal</a></li>
</ul></li>
<li class="chapter" data-level="5.7" data-path="built-in-independent-mh-proposals.html"><a href="built-in-independent-mh-proposals.html"><i class="fa fa-check"></i><b>5.7</b> Built-in independent MH proposals</a>
<ul>
<li class="chapter" data-level="5.7.1" data-path="built-in-independent-mh-proposals.html"><a href="built-in-independent-mh-proposals.html#imh_proposal"><i class="fa fa-check"></i><b>5.7.1</b> imh_proposal</a></li>
</ul></li>
<li class="chapter" data-level="5.8" data-path="user-defined-mh-proposals.html"><a href="user-defined-mh-proposals.html"><i class="fa fa-check"></i><b>5.8</b> User-defined MH proposals</a>
<ul>
<li class="chapter" data-level="5.8.1" data-path="user-defined-mh-proposals.html"><a href="user-defined-mh-proposals.html#simulate_mh_proposal"><i class="fa fa-check"></i><b>5.8.1</b> simulate_mh_proposal</a></li>
<li class="chapter" data-level="5.8.2" data-path="user-defined-mh-proposals.html"><a href="user-defined-mh-proposals.html#evaluate_log_mh_proposal"><i class="fa fa-check"></i><b>5.8.2</b> evaluate_log_mh_proposal</a></li>
</ul></li>
<li class="chapter" data-level="5.9" data-path="built-in-mh-proposals.html"><a href="built-in-mh-proposals.html"><i class="fa fa-check"></i><b>5.9</b> Built-in MH proposals</a>
<ul>
<li class="chapter" data-level="5.9.1" data-path="built-in-mh-proposals.html"><a href="built-in-mh-proposals.html#mh_proposal"><i class="fa fa-check"></i><b>5.9.1</b> mh_proposal</a></li>
</ul></li>
<li class="chapter" data-level="5.10" data-path="user-defined-unadjusted-proposals.html"><a href="user-defined-unadjusted-proposals.html"><i class="fa fa-check"></i><b>5.10</b> User-defined unadjusted proposals</a>
<ul>
<li class="chapter" data-level="5.10.1" data-path="user-defined-unadjusted-proposals.html"><a href="user-defined-unadjusted-proposals.html#simulate_unadjusted_proposal"><i class="fa fa-check"></i><b>5.10.1</b> simulate_unadjusted_proposal</a></li>
</ul></li>
<li class="chapter" data-level="5.11" data-path="built-in-unadjusted-proposals.html"><a href="built-in-unadjusted-proposals.html"><i class="fa fa-check"></i><b>5.11</b> Built-in unadjusted proposals</a>
<ul>
<li class="chapter" data-level="5.11.1" data-path="built-in-unadjusted-proposals.html"><a href="built-in-unadjusted-proposals.html#unadjusted_proposal"><i class="fa fa-check"></i><b>5.11.1</b> unadjusted_proposal</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="smc.html"><a href="smc.html"><i class="fa fa-check"></i><b>6</b> Importance sampling and sequential Monte Carlo</a>
<ul>
<li class="chapter" data-level="6.1" data-path="is-user.html"><a href="is-user.html"><i class="fa fa-check"></i><b>6.1</b> User-defined proposals {#user-proposal}</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="is-user.html"><a href="is-user.html#simulate_is_proposal"><i class="fa fa-check"></i><b>6.1.1</b> simulate_is_proposal</a></li>
<li class="chapter" data-level="6.1.2" data-path="is-user.html"><a href="is-user.html#evaluate_log_is_proposal"><i class="fa fa-check"></i><b>6.1.2</b> evaluate_log_is_proposal</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="is-builtin.html"><a href="is-builtin.html"><i class="fa fa-check"></i><b>6.2</b> Built-in proposals {#ilike-proposal}</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="is-builtin.html"><a href="is-builtin.html#is_proposal"><i class="fa fa-check"></i><b>6.2.1</b> is_proposal</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="adaptive-resampling.html"><a href="adaptive-resampling.html"><i class="fa fa-check"></i><b>6.3</b> Adaptive resampling</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="adaptive-resampling.html"><a href="adaptive-resampling.html#adaptive_resampling"><i class="fa fa-check"></i><b>6.3.1</b> adaptive_resampling</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="smc-sequence.html"><a href="smc-sequence.html"><i class="fa fa-check"></i><b>6.4</b> SMC sequence</a>
<ul>
<li class="chapter" data-level="6.4.1" data-path="smc-sequence.html"><a href="smc-sequence.html#smc_sequence"><i class="fa fa-check"></i><b>6.4.1</b> smc_sequence</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="adaptive-target.html"><a href="adaptive-target.html"><i class="fa fa-check"></i><b>6.5</b> Adaptive target</a>
<ul>
<li class="chapter" data-level="6.5.1" data-path="adaptive-target.html"><a href="adaptive-target.html#adaptive_target"><i class="fa fa-check"></i><b>6.5.1</b> adaptive_target</a></li>
</ul></li>
<li class="chapter" data-level="6.6" data-path="smc-termination.html"><a href="smc-termination.html"><i class="fa fa-check"></i><b>6.6</b> SMC termination</a>
<ul>
<li class="chapter" data-level="6.6.1" data-path="smc-termination.html"><a href="smc-termination.html#smc_termination"><i class="fa fa-check"></i><b>6.6.1</b> smc_termination</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="ssm.html"><a href="ssm.html"><i class="fa fa-check"></i><b>7</b> State-space models</a>
<ul>
<li class="chapter" data-level="7.1" data-path="state-space-supporting-detail.html"><a href="state-space-supporting-detail.html"><i class="fa fa-check"></i><b>7.1</b> State-space supporting detail</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="state-space-supporting-detail.html"><a href="state-space-supporting-detail.html#ssm-1"><i class="fa fa-check"></i><b>7.1.1</b> ssm</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="linear-gaussian-transition-model.html"><a href="linear-gaussian-transition-model.html"><i class="fa fa-check"></i><b>7.2</b> Linear-Gaussian transition model</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="linear-gaussian-transition-model.html"><a href="linear-gaussian-transition-model.html#linear_gaussian_transition_variable"><i class="fa fa-check"></i><b>7.2.1</b> linear_gaussian_transition_variable</a></li>
<li class="chapter" data-level="7.2.2" data-path="linear-gaussian-transition-model.html"><a href="linear-gaussian-transition-model.html#linear_gaussian_transition_matrix"><i class="fa fa-check"></i><b>7.2.2</b> linear_gaussian_transition_matrix</a></li>
<li class="chapter" data-level="7.2.3" data-path="linear-gaussian-transition-model.html"><a href="linear-gaussian-transition-model.html#linear_gaussian_transition_covariance"><i class="fa fa-check"></i><b>7.2.3</b> linear_gaussian_transition_covariance</a></li>
<li class="chapter" data-level="7.2.4" data-path="linear-gaussian-transition-model.html"><a href="linear-gaussian-transition-model.html#linear_gaussian_transition_model"><i class="fa fa-check"></i><b>7.2.4</b> linear_gaussian_transition_model</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="nonlinear-gaussian-transition-model.html"><a href="nonlinear-gaussian-transition-model.html"><i class="fa fa-check"></i><b>7.3</b> Nonlinear-Gaussian transition model</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="nonlinear-gaussian-transition-model.html"><a href="nonlinear-gaussian-transition-model.html#nonlinear_gaussian_transition_variable"><i class="fa fa-check"></i><b>7.3.1</b> nonlinear_gaussian_transition_variable</a></li>
<li class="chapter" data-level="7.3.2" data-path="nonlinear-gaussian-transition-model.html"><a href="nonlinear-gaussian-transition-model.html#nonlinear_gaussian_transition_function"><i class="fa fa-check"></i><b>7.3.2</b> nonlinear_gaussian_transition_function</a></li>
<li class="chapter" data-level="7.3.3" data-path="nonlinear-gaussian-transition-model.html"><a href="nonlinear-gaussian-transition-model.html#nonlinear_gaussian_transition_covariance"><i class="fa fa-check"></i><b>7.3.3</b> nonlinear_gaussian_transition_covariance</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="user-defined-transition-model.html"><a href="user-defined-transition-model.html"><i class="fa fa-check"></i><b>7.4</b> User-defined transition model</a>
<ul>
<li class="chapter" data-level="7.4.1" data-path="user-defined-transition-model.html"><a href="user-defined-transition-model.html#simulate_transition-model"><i class="fa fa-check"></i><b>7.4.1</b> simulate_transition model</a></li>
<li class="chapter" data-level="7.4.2" data-path="user-defined-transition-model.html"><a href="user-defined-transition-model.html#evaluate_log_transition_model"><i class="fa fa-check"></i><b>7.4.2</b> evaluate_log_transition_model</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="linear-gaussian-transition-proposal.html"><a href="linear-gaussian-transition-proposal.html"><i class="fa fa-check"></i><b>7.5</b> Linear-Gaussian transition proposal</a>
<ul>
<li class="chapter" data-level="7.5.1" data-path="linear-gaussian-transition-proposal.html"><a href="linear-gaussian-transition-proposal.html#linear_gaussian_transition_variable-1"><i class="fa fa-check"></i><b>7.5.1</b> linear_gaussian_transition_variable</a></li>
<li class="chapter" data-level="7.5.2" data-path="linear-gaussian-transition-proposal.html"><a href="linear-gaussian-transition-proposal.html#linear_gaussian_transition_matrix-1"><i class="fa fa-check"></i><b>7.5.2</b> linear_gaussian_transition_matrix</a></li>
<li class="chapter" data-level="7.5.3" data-path="linear-gaussian-transition-proposal.html"><a href="linear-gaussian-transition-proposal.html#linear_gaussian_transition_covariance-1"><i class="fa fa-check"></i><b>7.5.3</b> linear_gaussian_transition_covariance</a></li>
<li class="chapter" data-level="7.5.4" data-path="linear-gaussian-transition-proposal.html"><a href="linear-gaussian-transition-proposal.html#linear_gaussian_transition_proposal"><i class="fa fa-check"></i><b>7.5.4</b> linear_gaussian_transition_proposal</a></li>
</ul></li>
<li class="chapter" data-level="7.6" data-path="nonlinear-gaussian-transition-proposal.html"><a href="nonlinear-gaussian-transition-proposal.html"><i class="fa fa-check"></i><b>7.6</b> Nonlinear-Gaussian transition proposal</a>
<ul>
<li class="chapter" data-level="7.6.1" data-path="nonlinear-gaussian-transition-proposal.html"><a href="nonlinear-gaussian-transition-proposal.html#nonlinear_gaussian_transition_variable-1"><i class="fa fa-check"></i><b>7.6.1</b> nonlinear_gaussian_transition_variable</a></li>
<li class="chapter" data-level="7.6.2" data-path="nonlinear-gaussian-transition-proposal.html"><a href="nonlinear-gaussian-transition-proposal.html#nonlinear_gaussian_transition_function-1"><i class="fa fa-check"></i><b>7.6.2</b> nonlinear_gaussian_transition_function</a></li>
<li class="chapter" data-level="7.6.3" data-path="nonlinear-gaussian-transition-proposal.html"><a href="nonlinear-gaussian-transition-proposal.html#nonlinear_gaussian_transition_covariance-1"><i class="fa fa-check"></i><b>7.6.3</b> nonlinear_gaussian_transition_covariance</a></li>
</ul></li>
<li class="chapter" data-level="7.7" data-path="user-defined-transition-proposal.html"><a href="user-defined-transition-proposal.html"><i class="fa fa-check"></i><b>7.7</b> User-defined transition proposal</a>
<ul>
<li class="chapter" data-level="7.7.1" data-path="user-defined-transition-proposal.html"><a href="user-defined-transition-proposal.html#simulate_transition-proposal"><i class="fa fa-check"></i><b>7.7.1</b> simulate_transition proposal</a></li>
<li class="chapter" data-level="7.7.2" data-path="user-defined-transition-proposal.html"><a href="user-defined-transition-proposal.html#evaluate_log_transition_proposal"><i class="fa fa-check"></i><b>7.7.2</b> evaluate_log_transition_proposal</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="output.html"><a href="output.html"><i class="fa fa-check"></i><b>8</b> Loading and visualising output</a>
<ul>
<li class="chapter" data-level="8.1" data-path="mcmc-output.html"><a href="mcmc-output.html"><i class="fa fa-check"></i><b>8.1</b> MCMC output</a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="mcmc-output.html"><a href="mcmc-output.html#loading-mcmc-output-ilike-format"><i class="fa fa-check"></i><b>8.1.1</b> Loading MCMC output (ilike format)</a></li>
<li class="chapter" data-level="8.1.2" data-path="mcmc-output.html"><a href="mcmc-output.html#plotting-using-ggsmc"><i class="fa fa-check"></i><b>8.1.2</b> Plotting using <code>ggsmc</code></a></li>
<li class="chapter" data-level="8.1.3" data-path="mcmc-output.html"><a href="mcmc-output.html#loading-mcmc-output-ggmcmc-format"><i class="fa fa-check"></i><b>8.1.3</b> Loading MCMC output (ggmcmc format)</a></li>
<li class="chapter" data-level="8.1.4" data-path="mcmc-output.html"><a href="mcmc-output.html#plotting-using-ggmcmc"><i class="fa fa-check"></i><b>8.1.4</b> Plotting using <code>ggmcmc</code></a></li>
<li class="chapter" data-level="8.1.5" data-path="mcmc-output.html"><a href="mcmc-output.html#burn-in-warm-up"><i class="fa fa-check"></i><b>8.1.5</b> Burn-in / warm-up</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="is-smc-output.html"><a href="is-smc-output.html"><i class="fa fa-check"></i><b>8.2</b> IS and SMC output</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="is-smc-output.html"><a href="is-smc-output.html#visualising-output-using-ggsmc"><i class="fa fa-check"></i><b>8.2.1</b> Visualising output using <code>ggsmc</code></a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="ensemble-kalman-output.html"><a href="ensemble-kalman-output.html"><i class="fa fa-check"></i><b>8.3</b> Ensemble Kalman output</a></li>
<li class="chapter" data-level="8.4" data-path="pivot-wider.html"><a href="pivot-wider.html"><i class="fa fa-check"></i><b>8.4</b> <code>pivot_wider</code> for ilike data</a></li>
<li class="chapter" data-level="8.5" data-path="output-detail.html"><a href="output-detail.html"><i class="fa fa-check"></i><b>8.5</b> Further detail about output files</a>
<ul>
<li class="chapter" data-level="8.5.1" data-path="output-detail.html"><a href="output-detail.html#smc-output"><i class="fa fa-check"></i><b>8.5.1</b> SMC output</a></li>
<li class="chapter" data-level="8.5.2" data-path="output-detail.html"><a href="output-detail.html#ensemble-output"><i class="fa fa-check"></i><b>8.5.2</b> Ensemble output</a></li>
<li class="chapter" data-level="8.5.3" data-path="output-detail.html"><a href="output-detail.html#kalman-filter-output"><i class="fa fa-check"></i><b>8.5.3</b> Kalman filter output</a></li>
<li class="chapter" data-level="8.5.4" data-path="output-detail.html"><a href="output-detail.html#exact-output"><i class="fa fa-check"></i><b>8.5.4</b> Exact output</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="examples.html"><a href="examples.html"><i class="fa fa-check"></i><b>9</b> Examples</a>
<ul>
<li class="chapter" data-level="9.1" data-path="mcmc-gaussian.html"><a href="mcmc-gaussian.html"><i class="fa fa-check"></i><b>9.1</b> MCMC algorithms for sampling from a Gaussian</a></li>
<li class="chapter" data-level="9.2" data-path="smc-from-mcmc.html"><a href="smc-from-mcmc.html"><i class="fa fa-check"></i><b>9.2</b> Converting an MCMC into an SMC sampler</a></li>
<li class="chapter" data-level="9.3" data-path="filtering_cv.html"><a href="filtering_cv.html"><i class="fa fa-check"></i><b>9.3</b> Filtering on a constant velocity model</a></li>
<li class="chapter" data-level="9.4" data-path="mcmc-lv.html"><a href="mcmc-lv.html"><i class="fa fa-check"></i><b>9.4</b> MCMC on the Lotka-Volterra model</a></li>
<li class="chapter" data-level="9.5" data-path="abc-smc-lv.html"><a href="abc-smc-lv.html"><i class="fa fa-check"></i><b>9.5</b> ABC-SMC for the Lotka-Volterra model</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="bugs.html"><a href="bugs.html"><i class="fa fa-check"></i><b>10</b> Known issues and glaring omissions</a>
<ul>
<li class="chapter" data-level="10.1" data-path="known-issues.html"><a href="known-issues.html"><i class="fa fa-check"></i><b>10.1</b> Known issues</a></li>
<li class="chapter" data-level="10.2" data-path="glaring-omissions.html"><a href="glaring-omissions.html"><i class="fa fa-check"></i><b>10.2</b> Glaring omissions</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="debugging.html"><a href="debugging.html"><i class="fa fa-check"></i><b>11</b> Debugging ilike</a>
<ul>
<li class="chapter" data-level="11.1" data-path="error-in-could-not-find-function.html"><a href="error-in-could-not-find-function.html"><i class="fa fa-check"></i><b>11.1</b> Error in …: could not find function “…”</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">ilike documentation</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="inference-mcmc" class="section level2 hasAnchor" number="2.3">
<h2><span class="header-section-number">2.3</span> MCMC<a href="inference-mcmc.html#inference-mcmc" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="algorithm-1" class="section level3 hasAnchor" number="2.3.1">
<h3><span class="header-section-number">2.3.1</span> Algorithm<a href="inference-mcmc.html#algorithm-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Markov chain Monte Carlo (MCMC) uses a Markov chain whose limiting distribution is the desired target distribution <span class="math inline">\(\pi\)</span> to generate points that can be used to approximate <span class="math inline">\(\pi\)</span>. In most cases in practice this boils down to implementing the Metropolis-Hastings (MH) algorithm:</p>
<hr />
<p><strong>Metropolis-Hastings</strong></p>
<div class="line-block"><em>Starting with</em> <span class="math inline">\(\theta^0\)</span> iterate for <span class="math inline">\(i=1,2,\dots,n\)</span><br />
    <em>Draw</em> <span class="math inline">\(\theta^* \sim q(\cdot\mid \theta^{i-1})\)</span>.<br />
    <em>Compute</em><br />
<br />
   <span class="math display">\[\alpha(\theta^* \mid \theta^{i-1})=\min\left\{1,\frac{\displaystyle \tilde{\pi}(\theta^*) q(\theta^{i-1}\mid \theta^*)}{\tilde{\pi}(\theta^{i-1}) q(\theta^*\mid \theta^{i-1})} \right\}.\]</span><br />
<br />
   <em>With probability</em> <span class="math inline">\(\alpha(\theta^* \mid \theta^{i-1})\)</span> set <span class="math inline">\(\theta^i=\theta^*\)</span>, otherwise set <span class="math inline">\(\theta^i=\theta^{i-1}\)</span>.<br />
<strong>OUTPUT:</strong> <span class="math inline">\(\left\{\theta^i\right\}_{i=1}^n\)</span></div>
<hr />
<p>Here <span class="math inline">\(q\)</span> is <em>proposal</em> distribution that is used at each iteration to propose a candidate point <span class="math inline">\(\theta^*\)</span> conditional on the current state of the chain <span class="math inline">\(\theta^{i-1}\)</span>. The choice of proposal dramatically affects the efficiency of the algorithm.</p>
<p>Despite the apparent simplicity of this algorithm, MCMC encompasses a wide range of different approaches. Most well-known methods, including Gibbs sampling, MALA, HMC and NUTS are special cases of MH. For a description of a number of common approaches, see <span class="citation">Brooks et al. (<a href="#ref-brooks2011handbook">2011</a>)</span>.</p>
<p>Most of the specification of an MCMC algorithm in ilike is done through the receipe: see section <a href="mcmc.html#mcmc">5</a> for full detail. Section <a href="mcmc-output.html#mcmc-output">8.1</a> then describes how to visualise the output of the MCMC algorithm after it has finished running. In this section we only describe how to run the MCMC algorithm, through calling the <code>MCMC</code> function.</p>
<p><code>MCMC</code> does not return anything<a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a>, but writes output to the specified <code>results_name</code> directory. In addition to the arguments described in section <a href="inference-arguments.html#inference-arguments">2.1</a>, the <code>MCMC</code> takes the arguments:</p>
<ul>
<li><code>initial_values</code> (required) A list of lists containing the initial values for the chains. The length of the outer list should be equal to the number of chains; the inner list specifies the initial values of the parameters for each chain. For example, for a single chain on a model with parameters <span class="math inline">\(\alpha\)</span> and <span class="math inline">\(\beta\)</span>, if we wanted the initial values to be 1 and 2 respectively, we would use</li>
</ul>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="inference-mcmc.html#cb1-1" tabindex="-1"></a>initial_values <span class="ot">=</span> <span class="fu">list</span>(<span class="fu">list</span>(α<span class="ot">=</span><span class="dv">1</span>, β<span class="ot">=</span><span class="dv">2</span>))</span></code></pre></div>
<p>In the, relatively common, case where we would like to start multiple chains at the same point, one solution is to use the <code>replicate</code> function to repeat the initial values. For example, to start 3 chains at the same point, we would use</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="inference-mcmc.html#cb2-1" tabindex="-1"></a>initial_values <span class="ot">=</span> <span class="fu">replicate</span>(<span class="dv">3</span>, <span class="fu">list</span>(α<span class="ot">=</span><span class="dv">1</span>, β<span class="ot">=</span><span class="dv">2</span>), <span class="at">simplify=</span><span class="cn">FALSE</span>)</span></code></pre></div>
<ul>
<li><code>number_of_chains</code> (optional) The number of MCMC chains to run (default is 1). The number of chains needs to match the number of initial values provided.</li>
</ul>
</div>
<div id="ilike-recipe-requirements-1" class="section level3 hasAnchor" number="2.3.2">
<h3><span class="header-section-number">2.3.2</span> ilike recipe requirements<a href="inference-mcmc.html#ilike-recipe-requirements-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>To run an MCMC algorithm the user needs to provide the following in the recipe:</p>
<ol style="list-style-type: decimal">
<li><p>a method for updating the chain;</p></li>
<li><p>the criterion for terminating the chain.</p></li>
</ol>
<p>A complete description is provided in section <a href="mcmc.html#mcmc">5</a>.</p>
</div>
</div>
<h3>References<a href="references.html#references" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div id="ref-brooks2011handbook" class="csl-entry">
Brooks, Steve, Andrew Gelman, Galin Jones, and Xiao-Li Meng. 2011. <em>Handbook of <span>M</span>arkov Chain <span>M</span>onte <span>C</span>arlo</em>. <span>CRC</span> press.
</div>
</div>
<div class="footnotes">
<hr />
<ol start="1">
<li id="fn1"><p>MCMC output does not provide any useful direct estimate of <span class="math inline">\(Z\)</span>. So in order to be be consistent with other inference algorithms which return the an estimate of <span class="math inline">\(Z\)</span>.<a href="inference-mcmc.html#fnref1" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="inference-is.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="inference-smc.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/richardgeveritt/ilike_documentation/edit/master/inference.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["ilike docs.pdf", "ilike docs.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
